---
title: Benutzeroberflächen Automatisierung eines benutzerdefinierten Steuer Elements
ms.date: 03/30/2017
ms.topic: overview
dev_langs:
- csharp
- vb
helpviewer_keywords:
- custom controls [WPF], applying UI automation
- accessibility [WPF], applying to custom controls
- custom controls [WPF], improving accessibility
- UI Automation [WPF], using with custom controls
ms.assetid: 47b310fc-fbd5-4ce2-a606-22d04c6d4911
ms.openlocfilehash: 684f08a2a56c2095163c3deeed0223dabad2cea7
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/09/2020
ms.locfileid: "96977699"
---
# <a name="ui-automation-of-a-wpf-custom-control"></a><span data-ttu-id="415c4-102">Benutzeroberflächenautomatisierung eines benutzerdefinierten WPF-Steuerelements</span><span class="sxs-lookup"><span data-stu-id="415c4-102">UI Automation of a WPF Custom Control</span></span>
[!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="415c4-103">stellt eine einzelne allgemeine Schnittstelle bereit, die Automatisierungsclients zum Untersuchen oder Ausführen der Benutzerschnittstellen in unterschiedlichen Plattformen und Frameworks verwenden können.</span><span class="sxs-lookup"><span data-stu-id="415c4-103">provides a single, generalized interface that automation clients can use to examine or operate the user interfaces of a variety of platforms and frameworks.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="415c4-104">ermöglicht es jeweils Qualitätssicherungcode (Testcode) und Barrierefreiheitsanwendungen, z.B. die Sprachausgabe, Benutzerschnittstellenelemente zu untersuchen und Benutzerzugriff mit ihnen aus anderem Code zu simulieren.</span><span class="sxs-lookup"><span data-stu-id="415c4-104">enables both quality-assurance (test) code and accessibility applications such as screen readers to examine user-interface elements and simulate user interaction with them from other code.</span></span> <span data-ttu-id="415c4-105">Informationen zu [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] für alle Plattformen finden Sie unter „Barrierefreiheit“.</span><span class="sxs-lookup"><span data-stu-id="415c4-105">For information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] across all platforms, see Accessibility.</span></span>  
  
 <span data-ttu-id="415c4-106">In diesem Thema wird beschrieben, wie ein serverseitiger Benutzeroberflächenautomatisierungs-Anbieter, der in einer WPF-Anwendung ausgeführt wird, für ein benutzerdefiniertes Steuerelement implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="415c4-106">This topic describes how to implement a server-side UI Automation provider for a custom control that runs in a WPF application.</span></span> <span data-ttu-id="415c4-107">WPF unterstützt [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] über eine Struktur von Peer-Automatisierungsobjekten, die zur Struktur der Elemente der Benutzeroberfläche parallel ist.</span><span class="sxs-lookup"><span data-stu-id="415c4-107">WPF supports [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a tree of peer automation objects that parallels the tree of user interface elements.</span></span> <span data-ttu-id="415c4-108">Testcode und -anwendungen, die Barrierefreiheitsfunktionen bereitstellen, können Automatisierungspeerobjekte direkt (für Code, der gerade ausgeführt wird) oder über eine allgemeine Schnittstelle verwenden, die von [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="415c4-108">Test code and applications that provide accessibility features can use automation peer objects directly (for in-process code) or through the generalized interface provided by [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  

<a name="AutomationPeerClasses"></a>
## <a name="automation-peer-classes"></a><span data-ttu-id="415c4-109">Automatisierungspeerklassen</span><span class="sxs-lookup"><span data-stu-id="415c4-109">Automation Peer Classes</span></span>  
 <span data-ttu-id="415c4-110">WPF-Steuerelemente unterstützen [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] über eine Struktur von Peer Klassen, die von abgeleitet werden <xref:System.Windows.Automation.Peers.AutomationPeer> .</span><span class="sxs-lookup"><span data-stu-id="415c4-110">WPF controls support [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a tree of peer classes that derive from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="415c4-111">Gemäß der Konvention beginnen Namen von Peerklassen mit dem Klassennamen des Steuerelements und enden mit „AutomationPeer“.</span><span class="sxs-lookup"><span data-stu-id="415c4-111">By convention, peer class names begin with the control class name and end with "AutomationPeer".</span></span> <span data-ttu-id="415c4-112">Beispielsweise <xref:System.Windows.Automation.Peers.ButtonAutomationPeer> ist die Peer Klasse für die <xref:System.Windows.Controls.Button> Steuerelement Klasse.</span><span class="sxs-lookup"><span data-stu-id="415c4-112">For example, <xref:System.Windows.Automation.Peers.ButtonAutomationPeer> is the peer class for the <xref:System.Windows.Controls.Button> control class.</span></span> <span data-ttu-id="415c4-113">Die Peer Klassen entsprechen ungefähr den [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] Steuerelement Typen, sind jedoch für WPF-Elemente spezifisch.</span><span class="sxs-lookup"><span data-stu-id="415c4-113">The peer classes are roughly equivalent to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] control types but are specific to WPF elements.</span></span> <span data-ttu-id="415c4-114">Automatisierungscode der auf WPF-Anwendungen über die [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-Schnittstelle zugreift, verwendet keine Automatisierungspeers direkt, jedoch kann der Automatisierungscode im selben Prozessbereich Automatisierungspeers direkt verwenden.</span><span class="sxs-lookup"><span data-stu-id="415c4-114">Automation code that accesses WPF applications through the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] interface does not use automation peers directly, but automation code in the same process space can use automation peers directly.</span></span>  
  
<a name="BuiltInAutomationPeerClasses"></a>
## <a name="built-in-automation-peer-classes"></a><span data-ttu-id="415c4-115">Integrierte Automatisierungspeerklassen</span><span class="sxs-lookup"><span data-stu-id="415c4-115">Built-in Automation Peer Classes</span></span>  
 <span data-ttu-id="415c4-116">Elemente implementieren eine Automatisierungspeerklasse, wenn sie Schnittstellenaktivität vom Benutzer akzeptieren oder Informationen enthalten, die von Benutzern von Anwendungen der Sprachausgabe benötigt werden.</span><span class="sxs-lookup"><span data-stu-id="415c4-116">Elements implement an automation peer class if they accept interface activity from the user, or if they contain information needed by users of screen-reader applications.</span></span> <span data-ttu-id="415c4-117">Nicht alle visuellen WPF-Elemente verfügen über Automatisierungspeers.</span><span class="sxs-lookup"><span data-stu-id="415c4-117">Not all WPF visual elements have automation peers.</span></span> <span data-ttu-id="415c4-118">Beispiele für Klassen, die Automatisierungs Peers implementieren <xref:System.Windows.Controls.Button> , sind, <xref:System.Windows.Controls.TextBox> und <xref:System.Windows.Controls.Label> .</span><span class="sxs-lookup"><span data-stu-id="415c4-118">Examples of classes that implement automation peers are <xref:System.Windows.Controls.Button>, <xref:System.Windows.Controls.TextBox>, and <xref:System.Windows.Controls.Label>.</span></span> <span data-ttu-id="415c4-119">Beispiele für Klassen, die keine Automatisierungspeers implementieren, sind Klassen, die von abgeleitet werden, z. b. <xref:System.Windows.Controls.Decorator> <xref:System.Windows.Controls.Border> und Klassen, die auf basieren <xref:System.Windows.Controls.Panel> , z <xref:System.Windows.Controls.Grid> . b <xref:System.Windows.Controls.Canvas> .</span><span class="sxs-lookup"><span data-stu-id="415c4-119">Examples of classes that do not implement automation peers are classes that derive from <xref:System.Windows.Controls.Decorator>, such as <xref:System.Windows.Controls.Border>, and classes based on <xref:System.Windows.Controls.Panel>, such as <xref:System.Windows.Controls.Grid> and <xref:System.Windows.Controls.Canvas>.</span></span>  
  
 <span data-ttu-id="415c4-120">Die Basis <xref:System.Windows.Controls.Control> Klasse verfügt nicht über eine entsprechende Peer Klasse.</span><span class="sxs-lookup"><span data-stu-id="415c4-120">The base <xref:System.Windows.Controls.Control> class does not have a corresponding peer class.</span></span> <span data-ttu-id="415c4-121">Wenn Sie eine Peer Klasse benötigen, die einem benutzerdefinierten Steuerelement entspricht, das von abgeleitet <xref:System.Windows.Controls.Control> wird, sollten Sie die benutzerdefinierte Peer Klasse von ableiten <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer> .</span><span class="sxs-lookup"><span data-stu-id="415c4-121">If you need a peer class to correspond to a custom control that derives from <xref:System.Windows.Controls.Control>, you should derive the custom peer class from <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>.</span></span>  
  
<a name="SecurityConsiderations"></a>
## <a name="security-considerations-for-derived-peers"></a><span data-ttu-id="415c4-122">Sicherheitsüberlegungen zu abgeleiteten Peers</span><span class="sxs-lookup"><span data-stu-id="415c4-122">Security Considerations for Derived Peers</span></span>  
 <span data-ttu-id="415c4-123">Automatisierungspeers müssen in einer Teilausführungsumgebung ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="415c4-123">Automation peers must run in a partial-trust environment.</span></span> <span data-ttu-id="415c4-124">Code in der UIAutomationClient-Assembly ist nicht konfiguriert, in einer teilweise vertrauenswürdigen Umgebung ausgeführt zu werden, und Automatisierungspeercode sollte nicht auf diese Assembly verweisen.</span><span class="sxs-lookup"><span data-stu-id="415c4-124">Code in the UIAutomationClient assembly is not configured to run in a partial-trust environment, and automation peer code should not reference that assembly.</span></span> <span data-ttu-id="415c4-125">Stattdessen sollten Sie diese Klassen in der UIAutomationTypes-Assembly verwenden.</span><span class="sxs-lookup"><span data-stu-id="415c4-125">Instead, you should use the classes in the UIAutomationTypes assembly.</span></span> <span data-ttu-id="415c4-126">Sie sollten z. b. die- <xref:System.Windows.Automation.AutomationElementIdentifiers> Klasse aus der UIAutomationTypes-Assembly verwenden, die der- <xref:System.Windows.Automation.AutomationElement> Klasse in der UIAutomationClient-Assembly entspricht.</span><span class="sxs-lookup"><span data-stu-id="415c4-126">For example, you should use the <xref:System.Windows.Automation.AutomationElementIdentifiers> class from the UIAutomationTypes assembly, which corresponds to the <xref:System.Windows.Automation.AutomationElement> class in the UIAutomationClient assembly.</span></span> <span data-ttu-id="415c4-127">Es ist sicher, auf die UIAutomationTypes-Assembly in Automatisierungspeercode zu verweisen.</span><span class="sxs-lookup"><span data-stu-id="415c4-127">It is safe to reference the UIAutomationTypes assembly in automation peer code.</span></span>  
  
<a name="PeerNavigation"></a>
## <a name="peer-navigation"></a><span data-ttu-id="415c4-128">Peernavigation</span><span class="sxs-lookup"><span data-stu-id="415c4-128">Peer Navigation</span></span>  
 <span data-ttu-id="415c4-129">Nach dem Auffinden eines Automatisierungspeer kann in-Process-Code durch Aufrufen der-Methode und der-Methode des-Objekts durch Aufrufen der- <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildren%2A> <xref:System.Windows.Automation.Peers.AutomationPeer.GetParent%2A> Methode</span><span class="sxs-lookup"><span data-stu-id="415c4-129">After locating an automation peer, in-process code can navigate the peer tree by calling the object's <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildren%2A> and <xref:System.Windows.Automation.Peers.AutomationPeer.GetParent%2A> methods.</span></span> <span data-ttu-id="415c4-130">Die Navigation zwischen WPF-Elementen in einem-Steuerelement wird von der-Implementierung der-Methode des Peers unterstützt <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildrenCore%2A> .</span><span class="sxs-lookup"><span data-stu-id="415c4-130">Navigation among WPF elements within a control is supported by the peer's implementation of the <xref:System.Windows.Automation.Peers.AutomationPeer.GetChildrenCore%2A> method.</span></span> <span data-ttu-id="415c4-131">Das Benutzeroberflächenautomatisierungssystem ruft diese Methode auf, um eine Struktur von Unterelementen zu erstellen, die in einem Steuerelement vorhanden sind, z.B. Listenelemente in einem Listenfeld.</span><span class="sxs-lookup"><span data-stu-id="415c4-131">The UI Automation system calls this method to build up a tree of subelements contained within a control; for example, list items in a list box.</span></span> <span data-ttu-id="415c4-132">Die Standard <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A?displayProperty=nameWithType> Methode durchläuft die visuelle Struktur der Elemente, um die Struktur von Automatisierungspeers zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="415c4-132">The default <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A?displayProperty=nameWithType> method traverses the visual tree of elements to build the tree of automation peers.</span></span> <span data-ttu-id="415c4-133">Benutzerdefinierte Steuerelemente überschreiben diese Methode, um untergeordnete Elemente für Automatisierungsclients verfügbar zu machen, dabei werden die Automatisierungspeers von Elementen zurückgegeben, die Informationen ausdrücken oder Benutzerinteraktion erlauben.</span><span class="sxs-lookup"><span data-stu-id="415c4-133">Custom controls override this method to expose children elements to automation clients, returning the automation peers of elements that convey information or allow user interaction.</span></span>  
  
<a name="Customizations"></a>
## <a name="customizations-in-a-derived-peer"></a><span data-ttu-id="415c4-134">Anpassungen in einem abgeleiteten Peer</span><span class="sxs-lookup"><span data-stu-id="415c4-134">Customizations in a Derived Peer</span></span>  
 <span data-ttu-id="415c4-135">Alle Klassen, die von abgeleitet werden <xref:System.Windows.UIElement> und <xref:System.Windows.ContentElement> die geschützte virtuelle Methode enthalten <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> .</span><span class="sxs-lookup"><span data-stu-id="415c4-135">All classes that derive from <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement> contain the protected virtual method <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A>.</span></span> <span data-ttu-id="415c4-136">WPF-Aufrufe <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> , um das Automatisierungs Peer Objekt für jedes Steuerelement zu erhalten.</span><span class="sxs-lookup"><span data-stu-id="415c4-136">WPF calls <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> to get the automation peer object for each control.</span></span> <span data-ttu-id="415c4-137">Automatisierungscode kann Peers zum Abrufen von Informationen über Merkmale und Funktionen des Steuerelements verwenden und um interaktive Verwendung zu simulieren.</span><span class="sxs-lookup"><span data-stu-id="415c4-137">Automation code can use the peer to get information about a control’s characteristics and features and to simulate interactive use.</span></span> <span data-ttu-id="415c4-138">Ein benutzerdefiniertes Steuerelement, das Automation unterstützt, muss <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> eine Instanz einer von abgeleiteten Klasse überschreiben und zurückgeben <xref:System.Windows.Automation.Peers.AutomationPeer> .</span><span class="sxs-lookup"><span data-stu-id="415c4-138">A custom control that supports automation must override <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> and return an instance of a class that derives from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="415c4-139">Wenn ein benutzerdefiniertes Steuerelement beispielsweise von der- <xref:System.Windows.Controls.Primitives.ButtonBase> Klasse abgeleitet ist, sollte das von zurückgegebene-Objekt <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> von abgeleitet werden <xref:System.Windows.Automation.Peers.ButtonBaseAutomationPeer> .</span><span class="sxs-lookup"><span data-stu-id="415c4-139">For example, if a custom control derives from the <xref:System.Windows.Controls.Primitives.ButtonBase> class, then the object returned by <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> should derive from <xref:System.Windows.Automation.Peers.ButtonBaseAutomationPeer>.</span></span>  
  
 <span data-ttu-id="415c4-140">Wenn Sie ein benutzerdefiniertes Steuerelement implementieren, müssen Sie die „Kernmethoden“ der grundlegenden Automatisierungspeerklasse außer Kraft setzen, die das Verhalten eindeutig beschreiben und für Ihr benutzerdefiniertes Steuerelement spezifisch sind.</span><span class="sxs-lookup"><span data-stu-id="415c4-140">When implementing a custom control, you must override the "Core" methods from the base automation peer class that describe behavior unique and specific to your custom control.</span></span>  
  
### <a name="override-oncreateautomationpeer"></a><span data-ttu-id="415c4-141">OnCreateAutomationPeer außer Kraft setzen</span><span class="sxs-lookup"><span data-stu-id="415c4-141">Override OnCreateAutomationPeer</span></span>  
 <span data-ttu-id="415c4-142">Überschreiben <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> Sie die-Methode für das benutzerdefinierte Steuerelement, sodass es das Anbieter Objekt zurückgibt, das direkt oder indirekt von abgeleitet werden muss <xref:System.Windows.Automation.Peers.AutomationPeer> .</span><span class="sxs-lookup"><span data-stu-id="415c4-142">Override the <xref:System.Windows.UIElement.OnCreateAutomationPeer%2A> method for your custom control so that it returns your provider object, which must derive directly or indirectly from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span>  
  
### <a name="override-getpattern"></a><span data-ttu-id="415c4-143">GetPattern außer Kraft setzen</span><span class="sxs-lookup"><span data-stu-id="415c4-143">Override GetPattern</span></span>  
 <span data-ttu-id="415c4-144">Automatisierungspeers vereinfachen zwar manche technischen Aspekte der Implementierung von serverseitigen [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-Anbietern, aber Automatisierungspeers von benutzerdefinierten Steuerelementen müssen dennoch Musterschnittstellen behandeln.</span><span class="sxs-lookup"><span data-stu-id="415c4-144">Automation peers simplify some implementation aspects of server-side [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] providers, but custom control automation peers must still handle pattern interfaces.</span></span> <span data-ttu-id="415c4-145">Wie nicht-WPF-Anbieter unterstützen Peers Steuerelement Muster, indem Sie Implementierungen von Schnittstellen im- <xref:System.Windows.Automation.Provider?displayProperty=nameWithType> Namespace bereitstellen, z <xref:System.Windows.Automation.Provider.IInvokeProvider> . b..</span><span class="sxs-lookup"><span data-stu-id="415c4-145">Like non-WPF providers, peers support control patterns by providing implementations of interfaces in the <xref:System.Windows.Automation.Provider?displayProperty=nameWithType> namespace, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="415c4-146">Die Schnittstellen der Steuerelementmuster können entweder vom Peer selbst, oder von einem anderen Objekt implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="415c4-146">The control pattern interfaces can be implemented by the peer itself or by another object.</span></span> <span data-ttu-id="415c4-147">Die Peer-Implementierung von <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> gibt das Objekt zurück, das das angegebene Muster unterstützt.</span><span class="sxs-lookup"><span data-stu-id="415c4-147">The peer's implementation of <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> returns the object that supports the specified pattern.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="415c4-148">der Code Ruft die <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> Methode auf und gibt einen- <xref:System.Windows.Automation.Peers.PatternInterface> Enumerationswert an.</span><span class="sxs-lookup"><span data-stu-id="415c4-148">code calls the <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> method and specifies a <xref:System.Windows.Automation.Peers.PatternInterface> enumeration value.</span></span> <span data-ttu-id="415c4-149">Die außer Kraft Setzung von <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> sollte das Objekt zurückgeben, das das angegebene Muster implementiert.</span><span class="sxs-lookup"><span data-stu-id="415c4-149">Your override of <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> should return the object that implements the specified pattern.</span></span> <span data-ttu-id="415c4-150">Wenn das Steuerelement keine benutzerdefinierte Implementierung eines Musters hat, können Sie die-Implementierung des Basistyps aufrufen <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> , um entweder seine-Implementierung abzurufen, oder NULL, wenn das Muster für diesen Steuerelement Typen nicht unterstützt wird.</span><span class="sxs-lookup"><span data-stu-id="415c4-150">If your control does not have a custom implementation of a pattern, you can call the base type's implementation of <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> to retrieve either its implementation or null if the pattern is not supported for this control type.</span></span> <span data-ttu-id="415c4-151">Beispielsweise kann ein benutzerdefiniertes NumericUpDown-Steuerelement auf einen Wert innerhalb eines Bereichs festgelegt werden, sodass [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] der Peer die- <xref:System.Windows.Automation.Provider.IRangeValueProvider> Schnittstelle implementieren würde.</span><span class="sxs-lookup"><span data-stu-id="415c4-151">For example, a custom NumericUpDown control can be set to a value within a range, so its [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] peer would implement the <xref:System.Windows.Automation.Provider.IRangeValueProvider> interface.</span></span> <span data-ttu-id="415c4-152">Im folgenden Beispiel wird gezeigt, wie die-Methode des Peers <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> überschrieben wird, um auf einen-Wert zu reagieren <xref:System.Windows.Automation.Peers.PatternInterface.RangeValue?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="415c4-152">The following example shows how the peer's <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> method is overridden to respond to a <xref:System.Windows.Automation.Peers.PatternInterface.RangeValue?displayProperty=nameWithType> value.</span></span>  
  
 [!code-csharp[CustomControlNumericUpDown#GetPattern](~/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/NumericUpDown.cs#getpattern)]
 [!code-vb[CustomControlNumericUpDown#GetPattern](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/numericupdown.vb#getpattern)]  
  
 <span data-ttu-id="415c4-153">Eine <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> Methode kann auch ein Unterelement als Muster Anbieter angeben.</span><span class="sxs-lookup"><span data-stu-id="415c4-153">A <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetPattern%2A> method can also specify a subelement as a pattern provider.</span></span> <span data-ttu-id="415c4-154">Der folgende Code zeigt, wie die <xref:System.Windows.Controls.ItemsControl> Verarbeitung von scrollmustern an den Peer des internen Steuer Elements überträgt <xref:System.Windows.Controls.ScrollViewer> .</span><span class="sxs-lookup"><span data-stu-id="415c4-154">The following code shows how <xref:System.Windows.Controls.ItemsControl> transfers scroll pattern handling to the peer of its internal <xref:System.Windows.Controls.ScrollViewer> control.</span></span>  
  
```csharp  
public override object GetPattern(PatternInterface patternInterface)  
{  
    if (patternInterface == PatternInterface.Scroll)  
    {  
        ItemsControl owner = (ItemsControl) base.Owner;  
  
        // ScrollHost is internal to the ItemsControl class  
        if (owner.ScrollHost != null)  
        {  
            AutomationPeer peer = UIElementAutomationPeer.CreatePeerForElement(owner.ScrollHost);  
            if ((peer != null) && (peer is IScrollProvider))  
            {  
                peer.EventsSource = this;  
                return (IScrollProvider) peer;  
            }  
        }  
    }  
    return base.GetPattern(patternInterface);  
}  
```  
  
```vb  
Public Class Class1  
    Public Overrides Function GetPattern(ByVal patternInterface__1 As PatternInterface) As Object  
        If patternInterface1 = PatternInterface.Scroll Then  
            Dim owner As ItemsControl = DirectCast(MyBase.Owner, ItemsControl)  
  
            ' ScrollHost is internal to the ItemsControl class  
            If owner.ScrollHost IsNot Nothing Then  
                Dim peer As AutomationPeer = UIElementAutomationPeer.CreatePeerForElement(owner.ScrollHost)  
                If (peer IsNot Nothing) AndAlso (TypeOf peer Is IScrollProvider) Then  
                    peer.EventsSource = Me  
                    Return DirectCast(peer, IScrollProvider)  
                End If  
            End If  
        End If  
        Return MyBase.GetPattern(patternInterface1)  
    End Function  
End Class  
```  
  
 <span data-ttu-id="415c4-155">Um ein Unterelement für die Muster Behandlung anzugeben, ruft dieser Code das untergeordnete Objekt ab, erstellt mithilfe der-Methode einen Peer, <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.CreatePeerForElement%2A> legt die <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> -Eigenschaft des neuen Peers auf den aktuellen Peer fest und gibt den neuen Peer zurück.</span><span class="sxs-lookup"><span data-stu-id="415c4-155">To specify a subelement for pattern handling, this code gets the subelement object, creates a peer by using the <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.CreatePeerForElement%2A> method, sets the <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> property of the new peer to the current peer, and returns the new peer.</span></span> <span data-ttu-id="415c4-156">Durch Festlegen von <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> für ein Unterelement wird verhindert, dass das Unterelement in der Automatisierungs Peer Struktur angezeigt wird, und es werden alle Ereignisse, die vom Unterelement ausgelöst werden, als Ausgangswert aus dem in angegebenen Steuerelement festgelegt <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> .</span><span class="sxs-lookup"><span data-stu-id="415c4-156">Setting <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A> on a subelement prevents the subelement from appearing in the automation peer tree and designates all events raised by the subelement as originating from the control specified in <xref:System.Windows.Automation.Peers.AutomationPeer.EventsSource%2A>.</span></span> <span data-ttu-id="415c4-157">Das <xref:System.Windows.Controls.ScrollViewer> -Steuerelement wird nicht in der Automatisierungs Struktur angezeigt, und die von ihm generierten scrollereignisse scheinen aus dem-Objekt zu stammen <xref:System.Windows.Controls.ItemsControl> .</span><span class="sxs-lookup"><span data-stu-id="415c4-157">The <xref:System.Windows.Controls.ScrollViewer> control does not appear in the automation tree, and scrolling events that it generates appear to originate from the <xref:System.Windows.Controls.ItemsControl> object.</span></span>  
  
### <a name="override-core-methods"></a><span data-ttu-id="415c4-158">„Kern“-Methode außer Kraft setzen</span><span class="sxs-lookup"><span data-stu-id="415c4-158">Override "Core" Methods</span></span>  
 <span data-ttu-id="415c4-159">Der Automatisierungscode ruft Informationen über Ihr Steuerelement ab, indem er die öffentlichen Methoden der Peer-Klasse aufruft.</span><span class="sxs-lookup"><span data-stu-id="415c4-159">Automation code gets information about your control by calling public methods of the peer class.</span></span> <span data-ttu-id="415c4-160">Um Informationen über Ihr Steuerelement bereitzustellen, setzen Sie jede Methode außer Kraft, deren Name mit „Core“ endet, falls die Implementierung Ihrer Steuerelemente sich von der Implementierung unterscheidet, die von der Basis-Automatisierungspeerklasse bereitgestellt wird.</span><span class="sxs-lookup"><span data-stu-id="415c4-160">To provide information about your control, override each method whose name ends with "Core" when your control implementation differs from that of that provided by the base automation peer class.</span></span> <span data-ttu-id="415c4-161">Das-Steuerelement muss mindestens die <xref:System.Windows.Automation.Peers.AutomationPeer.GetClassNameCore%2A> -Methode und die- <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> Methode implementieren, wie im folgenden Beispiel gezeigt.</span><span class="sxs-lookup"><span data-stu-id="415c4-161">At a minimum, your control must implement the <xref:System.Windows.Automation.Peers.AutomationPeer.GetClassNameCore%2A> and <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> methods, as shown in the following example.</span></span>  
  
 [!code-csharp[CustomControlNumericUpDown#CoreOverrides](~/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/NumericUpDown.cs#coreoverrides)]
 [!code-vb[CustomControlNumericUpDown#CoreOverrides](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/numericupdown.vb#coreoverrides)]  
  
 <span data-ttu-id="415c4-162">Ihre Implementierung von <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> beschreibt das Steuerelement, indem ein-Wert zurückgegeben wird <xref:System.Windows.Automation.ControlType> .</span><span class="sxs-lookup"><span data-stu-id="415c4-162">Your implementation of <xref:System.Windows.Automation.Peers.AutomationPeer.GetAutomationControlTypeCore%2A> describes your control by returning a <xref:System.Windows.Automation.ControlType> value.</span></span> <span data-ttu-id="415c4-163">Obwohl Sie zurückgeben können <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType> , sollten Sie einen der spezifischeren Steuerelement Typen zurückgeben, wenn er das Steuerelement genau beschreibt.</span><span class="sxs-lookup"><span data-stu-id="415c4-163">Although you can return <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType>, you should return one of the more specific control types if it accurately describes your control.</span></span> <span data-ttu-id="415c4-164">Der Rückgabewert <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType> erfordert zusätzliche Arbeit, damit der Anbieter implementiert [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , und [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] Client Produkte können die Steuerelement Struktur, die Tastatur Interaktion und mögliche Steuerelement Muster nicht vorhersehen.</span><span class="sxs-lookup"><span data-stu-id="415c4-164">A return value of <xref:System.Windows.Automation.ControlType.Custom?displayProperty=nameWithType> requires extra work for the provider to implement [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], and [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] client products are unable to anticipate the control structure, keyboard interaction, and possible control patterns.</span></span>  
  
 <span data-ttu-id="415c4-165">Implementieren Sie die <xref:System.Windows.Automation.Peers.AutomationPeer.IsContentElementCore%2A> -Methode und die- <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> Methode, um anzugeben, ob das Steuerelement Dateninhalte enthält oder eine interaktive Rolle in der Benutzeroberfläche erfüllt (oder beides).</span><span class="sxs-lookup"><span data-stu-id="415c4-165">Implement the <xref:System.Windows.Automation.Peers.AutomationPeer.IsContentElementCore%2A> and <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> methods to indicate whether your control contains data content or fulfills an interactive role in the user interface (or both).</span></span> <span data-ttu-id="415c4-166">Standardmäßig geben die beiden Methoden `true` zurück.</span><span class="sxs-lookup"><span data-stu-id="415c4-166">By default, both methods return `true`.</span></span> <span data-ttu-id="415c4-167">Diese Einstellungen verbessern die Nutzbarkeit der Automatisierungstools, wie z.B. Sprachausgabe-Tools, die mit diesen Methoden die Automatisierungsstruktur filtern.</span><span class="sxs-lookup"><span data-stu-id="415c4-167">These settings improve the usability of automation tools such as screen readers, which may use these methods to filter the automation tree.</span></span> <span data-ttu-id="415c4-168">Wenn die <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> Methode die Muster Verarbeitung an einen untergeordneten Peer überträgt, kann die-Methode des Subelements-Peers <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> false zurückgeben, um den subelarpeer aus der Automatisierungs Struktur auszublenden.</span><span class="sxs-lookup"><span data-stu-id="415c4-168">If your <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> method transfers pattern handling to a subelement peer, the subelement peer's <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> method can return false to hide the subelement peer from the automation tree.</span></span> <span data-ttu-id="415c4-169">Beispielsweise wird der Bildlauf in einem <xref:System.Windows.Controls.ListBox> von einer verarbeitet <xref:System.Windows.Controls.ScrollViewer> , und der <xref:System.Windows.Automation.Peers.PatternInterface.Scroll?displayProperty=nameWithType> Automatisierungspeer für wird von der-Methode der-Instanz zurückgegeben, die <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> dem zugeordnet ist <xref:System.Windows.Automation.Peers.ListBoxAutomationPeer> . Daher gibt die- <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> Methode von <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> zurück `false` , sodass der <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> nicht in der Automatisierungs Struktur angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="415c4-169">For example, scrolling in a <xref:System.Windows.Controls.ListBox> is handled by a <xref:System.Windows.Controls.ScrollViewer>, and the automation peer for <xref:System.Windows.Automation.Peers.PatternInterface.Scroll?displayProperty=nameWithType> is returned by the <xref:System.Windows.Automation.Peers.AutomationPeer.GetPattern%2A> method of the <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> that is associated with the <xref:System.Windows.Automation.Peers.ListBoxAutomationPeer>.Therefore, the <xref:System.Windows.Automation.Peers.AutomationPeer.IsControlElementCore%2A> method of the <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> returns `false`, so that the <xref:System.Windows.Automation.Peers.ScrollViewerAutomationPeer> does not appear in the automation tree.</span></span>  
  
 <span data-ttu-id="415c4-170">Ihr Automatisierungspeer sollte dem Steuerelement entsprechende Standardwerte bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="415c4-170">Your automation peer should provide appropriate default values for your control.</span></span> <span data-ttu-id="415c4-171">Beachten Sie, dass XAML, das auf das Steuerelement verweist, ihre Peer Implementierungen von Kern Methoden durch Einschließen von Attributen überschreiben kann <xref:System.Windows.Automation.AutomationProperties> .</span><span class="sxs-lookup"><span data-stu-id="415c4-171">Note that XAML that references your control can override your peer implementations of core methods by including <xref:System.Windows.Automation.AutomationProperties> attributes.</span></span> <span data-ttu-id="415c4-172">Der folgende XAML-Code erstellt z.B.. eine Schaltfläche mit zwei benutzerdefinierten [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="415c4-172">For example, the following XAML creates a button that has two customized [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties.</span></span>  
  
```xaml  
<Button AutomationProperties.Name="Special"
    AutomationProperties.HelpText="This is a special button."/>  
```  
  
### <a name="implement-pattern-providers"></a><span data-ttu-id="415c4-173">Implementieren von Musteranbietern</span><span class="sxs-lookup"><span data-stu-id="415c4-173">Implement Pattern Providers</span></span>  
 <span data-ttu-id="415c4-174">Die von einem benutzerdefinierten Anbieter implementierten Schnittstellen werden explizit deklariert, wenn das besitzende Element direkt von abgeleitet wird <xref:System.Windows.Controls.Control> .</span><span class="sxs-lookup"><span data-stu-id="415c4-174">The interfaces implemented by a custom provider are explicitly declared if the owning element derives directly from <xref:System.Windows.Controls.Control>.</span></span> <span data-ttu-id="415c4-175">Der folgende Code deklariert z. b. einen Peer für einen <xref:System.Windows.Controls.Control> , der einen Bereichs Wert implementiert.</span><span class="sxs-lookup"><span data-stu-id="415c4-175">For example, the following code declares a peer for a <xref:System.Windows.Controls.Control> that implements a range value.</span></span>  
  
```csharp  
public class RangePeer1 : FrameworkElementAutomationPeer, IRangeValueProvider { }  
```  
  
```vb  
Public Class RangePeer1  
    Inherits FrameworkElementAutomationPeer  
    Implements IRangeValueProvider  
End Class  
```  
  
 <span data-ttu-id="415c4-176">Wenn das besitzende Steuerelement von einem bestimmten Steuerelement, z <xref:System.Windows.Controls.Primitives.RangeBase> . b., abgeleitet ist, kann der Peer von einer entsprechenden abgeleiteten Peer Klasse abgeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="415c4-176">If the owning control derives from a specific type of control such as <xref:System.Windows.Controls.Primitives.RangeBase>, the peer can be derived from an equivalent derived peer class.</span></span> <span data-ttu-id="415c4-177">In diesem Fall wird der Peer von abgeleitet <xref:System.Windows.Automation.Peers.RangeBaseAutomationPeer> , der eine Basis Implementierung von bereitstellt <xref:System.Windows.Automation.Provider.IRangeValueProvider> .</span><span class="sxs-lookup"><span data-stu-id="415c4-177">In this case, the peer would derive from <xref:System.Windows.Automation.Peers.RangeBaseAutomationPeer>, which supplies a base implementation of <xref:System.Windows.Automation.Provider.IRangeValueProvider>.</span></span> <span data-ttu-id="415c4-178">Der folgende Code veranschaulicht die Deklaration eines solchen Peers.</span><span class="sxs-lookup"><span data-stu-id="415c4-178">The following code shows the declaration of such a peer.</span></span>  
  
```csharp  
public class RangePeer2 : RangeBaseAutomationPeer { }  
```  
  
```vb  
Public Class RangePeer2  
    Inherits RangeBaseAutomationPeer  
End Class  
```  
  
<span data-ttu-id="415c4-179">Eine Beispiel Implementierung finden Sie im [c#](https://github.com/dotnet/docs/tree/master/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp) -oder [Visual Basic](https://github.com/dotnet/docs/tree/master/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic) Quellcode, der implementiert und ein benutzerdefiniertes NumericUpDown-Steuerelement verwendet.</span><span class="sxs-lookup"><span data-stu-id="415c4-179">For an example implementation, see the [C#](https://github.com/dotnet/docs/tree/master/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp) or [Visual Basic](https://github.com/dotnet/docs/tree/master/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic) source code that implements and consumes a NumericUpDown custom control.</span></span>  
  
### <a name="raise-events"></a><span data-ttu-id="415c4-180">Auslösen von Ereignissen</span><span class="sxs-lookup"><span data-stu-id="415c4-180">Raise Events</span></span>  
 <span data-ttu-id="415c4-181">Automatisierungsclients können Automatisierungsereignisse abonnieren.</span><span class="sxs-lookup"><span data-stu-id="415c4-181">Automation clients can subscribe to automation events.</span></span> <span data-ttu-id="415c4-182">Benutzerdefinierte Steuerelemente müssen Änderungen zum Steuern des Zustands melden, indem Sie die- <xref:System.Windows.Automation.Peers.AutomationPeer.RaiseAutomationEvent%2A> Methode aufrufen.</span><span class="sxs-lookup"><span data-stu-id="415c4-182">Custom controls must report changes to control state by calling the <xref:System.Windows.Automation.Peers.AutomationPeer.RaiseAutomationEvent%2A> method.</span></span> <span data-ttu-id="415c4-183">Wenn sich ein Eigenschafts Wert ändert, wird auch die- <xref:System.Windows.Automation.Peers.AutomationPeer.RaisePropertyChangedEvent%2A> Methode aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="415c4-183">Similarly, when a property value changes, call the <xref:System.Windows.Automation.Peers.AutomationPeer.RaisePropertyChangedEvent%2A> method.</span></span> <span data-ttu-id="415c4-184">Der folgende Code zeigt, wie Sie das Peerobjekt aus dem Steuerelementcode abrufen und eine Methode zum Auslösen eines Ereignisses aufrufen.</span><span class="sxs-lookup"><span data-stu-id="415c4-184">The following code shows how to get the peer object from within the control code and call a method to raise an event.</span></span> <span data-ttu-id="415c4-185">Als Optimierung überprüft der Code, ob Listener für diesen Ereignistyp vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="415c4-185">As an optimization, the code determines if there are any listeners for this event type.</span></span> <span data-ttu-id="415c4-186">Ereignisse werden nur dann ausgelöst, wenn Listener vorhanden sind, sodass unnötiger Aufwand vermieden wird und das Steuerelement reaktionsfähig bleibt.</span><span class="sxs-lookup"><span data-stu-id="415c4-186">Raising the event only when there are listeners avoids unnecessary overhead and helps the control remain responsive.</span></span>  
  
 [!code-csharp[CustomControlNumericUpDown#RaiseEventFromControl](~/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/NumericUpDown.cs#raiseeventfromcontrol)]
 [!code-vb[CustomControlNumericUpDown#RaiseEventFromControl](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/numericupdown.vb#raiseeventfromcontrol)]  
  
## <a name="see-also"></a><span data-ttu-id="415c4-187">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="415c4-187">See also</span></span>

- [<span data-ttu-id="415c4-188">Übersicht über die Benutzeroberflächenautomatisierung</span><span class="sxs-lookup"><span data-stu-id="415c4-188">UI Automation Overview</span></span>](/dotnet/framework/ui-automation/ui-automation-overview)
- [<span data-ttu-id="415c4-189">Implementierung eines serverseitigen Benutzeroberflächenautomatisierungs-Anbieters</span><span class="sxs-lookup"><span data-stu-id="415c4-189">Server-Side UI Automation Provider Implementation</span></span>](/dotnet/framework/ui-automation/server-side-ui-automation-provider-implementation)
- [<span data-ttu-id="415c4-190">Benutzerdefiniertes NumericUpDown-Steuerelement (c#) auf GitHub</span><span class="sxs-lookup"><span data-stu-id="415c4-190">NumericUpDown custom control (C#) on GitHub</span></span>](https://github.com/dotnet/docs/tree/master/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp)  
- [<span data-ttu-id="415c4-191">Benutzerdefiniertes NumericUpDown-Steuerelement (Visual Basic) auf GitHub</span><span class="sxs-lookup"><span data-stu-id="415c4-191">NumericUpDown custom control (Visual Basic) on GitHub</span></span>](https://github.com/dotnet/docs/tree/master/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic)
