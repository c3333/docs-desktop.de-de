---
title: Abhängigkeitseigenschaften vom Auflistungstyp
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- properties [WPF], dependency
- properties [WPF], collection-type
- dependency properties [WPF]
- collection-type properties [WPF]
ms.assetid: 99f96a42-3ab7-4f64-a16b-2e10d654e97c
ms.openlocfilehash: 8da798b3d7254d10d8da7ca6df335f63e4890763
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/09/2020
ms.locfileid: "96976421"
---
# <a name="collection-type-dependency-properties"></a><span data-ttu-id="900cb-102">Abhängigkeitseigenschaften vom Auflistungstyp</span><span class="sxs-lookup"><span data-stu-id="900cb-102">Collection-Type Dependency Properties</span></span>
<span data-ttu-id="900cb-103">Dieses Thema enthält einen Leitfaden und empfohlene Muster zur Implementierung einer Abhängigkeitseigenschaft für Eigenschaften vom Auflistungstyp.</span><span class="sxs-lookup"><span data-stu-id="900cb-103">This topic provides guidance and suggested patterns for how to implement a dependency property where the type of the property is a collection type.</span></span>  

<a name="implementing"></a>
## <a name="implementing-a-collection-type-dependency-property"></a><span data-ttu-id="900cb-104">Implementieren einer Abhängigkeitseigenschaft vom Auflistungstyp</span><span class="sxs-lookup"><span data-stu-id="900cb-104">Implementing a Collection-Type Dependency Property</span></span>  
 <span data-ttu-id="900cb-105">Für eine Abhängigkeits Eigenschaft im Allgemeinen ist das folgende Implementierungs Muster, dass Sie einen CLR-Eigenschafts Wrapper definieren, bei dem diese Eigenschaft durch einen <xref:System.Windows.DependencyProperty> Bezeichner und nicht durch ein Feld oder ein anderes Konstrukt gestützt wird.</span><span class="sxs-lookup"><span data-stu-id="900cb-105">For a dependency property in general, the implementation pattern that you follow is that you define a CLR property wrapper, where that property is backed by a <xref:System.Windows.DependencyProperty> identifier rather than a field or other construct.</span></span> <span data-ttu-id="900cb-106">Folgen Sie diesem Muster auch bei der Implementierung einer Eigenschaft vom Auflistungstyp.</span><span class="sxs-lookup"><span data-stu-id="900cb-106">You follow this same pattern when you implement a collection-type property.</span></span> <span data-ttu-id="900cb-107">Eine Auflistungstyp Eigenschaft führt jedoch zu einer gewissen Komplexität des Musters, wenn der in der Auflistung enthaltene Typ selbst eine <xref:System.Windows.DependencyObject> oder eine <xref:System.Windows.Freezable> abgeleitete Klasse ist.</span><span class="sxs-lookup"><span data-stu-id="900cb-107">However, a collection-type property introduces some complexity to the pattern whenever the type that is contained within the collection is itself a <xref:System.Windows.DependencyObject> or <xref:System.Windows.Freezable> derived class.</span></span>  
  
<a name="initializing"></a>
## <a name="initializing-the-collection-beyond-the-default-value"></a><span data-ttu-id="900cb-108">Initialisieren der Auflistung für einen anderen Wert als den Standardwert</span><span class="sxs-lookup"><span data-stu-id="900cb-108">Initializing the Collection Beyond the Default Value</span></span>  
 <span data-ttu-id="900cb-109">Beim Erstellen einer Abhängigkeitseigenschaft geben Sie nicht den Standardwert der Eigenschaft als Anfangsfeldwert an.</span><span class="sxs-lookup"><span data-stu-id="900cb-109">When you create a dependency property, you do not specify the property default value as the initial field value.</span></span> <span data-ttu-id="900cb-110">Geben Sie den Standardwert stattdessen über die Metadaten für Abhängigkeitseigenschaften an.</span><span class="sxs-lookup"><span data-stu-id="900cb-110">Instead, you specify the default value through the dependency property metadata.</span></span> <span data-ttu-id="900cb-111">Handelt es sich bei der Eigenschaft um einen Verweistyp, ist der in den Metadaten für Abhängigkeitseigenschaften angegebene Standardwert kein Standardwert pro Instanz. Er stellt vielmehr einen Standardwert dar, der für alle Instanzen des Typs gilt.</span><span class="sxs-lookup"><span data-stu-id="900cb-111">If your property is a reference type, the default value specified in dependency property metadata is not a default value per instance; instead it is a default value that applies to all instances of the type.</span></span> <span data-ttu-id="900cb-112">Achten Sie also darauf, dass Sie nicht die durch die Metadaten für Auflistungseigenschaften definierte, einzelne statische Auflistung als funktionierenden Standardwert für neu erstellte Instanzen des Typs verwenden.</span><span class="sxs-lookup"><span data-stu-id="900cb-112">Therefore you must be careful to not use the singular static collection defined by the collection property metadata as the working default value for newly created instances of your type.</span></span> <span data-ttu-id="900cb-113">Vergewissern Sie sich stattdessen, dass Sie den Auflistungswert bewusst als eine eindeutige (Instanz-)Auflistung als Teil Ihrer Klassenkonstruktorlogik festlegen.</span><span class="sxs-lookup"><span data-stu-id="900cb-113">Instead, you must make sure that you deliberately set the collection value to a unique (instance) collection as part of your class constructor logic.</span></span> <span data-ttu-id="900cb-114">Andernfalls erstellen Sie unbeabsichtigterweise eine Singleton-Klasse.</span><span class="sxs-lookup"><span data-stu-id="900cb-114">Otherwise you will have created an unintentional singleton class.</span></span>  
  
 <span data-ttu-id="900cb-115">Betrachten Sie das folgende Beispiel.</span><span class="sxs-lookup"><span data-stu-id="900cb-115">Consider the following example.</span></span> <span data-ttu-id="900cb-116">Der folgende Abschnitt des Beispiels zeigt die Definition für eine-Klasse `Aquarium` , die einen Fehler mit dem Standardwert enthält.</span><span class="sxs-lookup"><span data-stu-id="900cb-116">The following section of the example shows the definition for a class `Aquarium`, which contains a flaw with the default value.</span></span> <span data-ttu-id="900cb-117">Die-Klasse definiert die Auflistungstyp-Abhängigkeits Eigenschaft `AquariumObjects` , die den generischen <xref:System.Collections.Generic.List%601> Typ mit einer <xref:System.Windows.FrameworkElement> Typeinschränkung verwendet.</span><span class="sxs-lookup"><span data-stu-id="900cb-117">The class defines the collection type dependency property `AquariumObjects`, which uses the generic <xref:System.Collections.Generic.List%601> type with a <xref:System.Windows.FrameworkElement> type constraint.</span></span> <span data-ttu-id="900cb-118">Im-Befehl <xref:System.Windows.DependencyProperty.Register%28System.String%2CSystem.Type%2CSystem.Type%2CSystem.Windows.PropertyMetadata%29> für die-Abhängigkeits Eigenschaft wird der Standardwert von den Metadaten als neuer generischer Wert festgelegt <xref:System.Collections.Generic.List%601> .</span><span class="sxs-lookup"><span data-stu-id="900cb-118">In the <xref:System.Windows.DependencyProperty.Register%28System.String%2CSystem.Type%2CSystem.Type%2CSystem.Windows.PropertyMetadata%29> call for the dependency property, the metadata establishes the default value to be a new generic <xref:System.Collections.Generic.List%601>.</span></span>

> [!WARNING]
> <span data-ttu-id="900cb-119">Der folgende Code verhält sich nicht ordnungsgemäß.</span><span class="sxs-lookup"><span data-stu-id="900cb-119">The following code does not behave correctly.</span></span>

 [!code-csharp[PropertiesOvwSupport2#CollectionProblemDefinition](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport2/CSharp/page.xaml.cs#collectionproblemdefinition)]
 [!code-vb[PropertiesOvwSupport2#CollectionProblemDefinition](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport2/visualbasic/page.xaml.vb#collectionproblemdefinition)]  
  
 <span data-ttu-id="900cb-120">Wenn Sie den Code unverändert lassen, wird dieser einzelne Listenstandardwert für alle Instanzen von `Aquarium` freigegeben.</span><span class="sxs-lookup"><span data-stu-id="900cb-120">However, if you just left the code as shown, that single list default value is shared for all instances of `Aquarium`.</span></span> <span data-ttu-id="900cb-121">Beim Ausführen des folgenden Testcodes, der zeigen soll, wie zwei getrennte `Aquarium`-Instanzen instanziiert und jeder ein einzelner unterschiedlicher `Fish` hinzugefügt würde, käme es zu einem überraschenden Ergebnis:</span><span class="sxs-lookup"><span data-stu-id="900cb-121">If you ran the following test code, which is intended to show how you would instantiate two separate `Aquarium` instances and add a single different `Fish` to each of them, you would see a surprising result:</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#CollectionProblemTestCode](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page4.xaml.cs#collectionproblemtestcode)]
 [!code-vb[PropertiesOvwSupport#CollectionProblemTestCode](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page4.xaml.vb#collectionproblemtestcode)]  
  
 <span data-ttu-id="900cb-122">Anstatt eines Eintrags besitzt jede Auflistung nun zwei!</span><span class="sxs-lookup"><span data-stu-id="900cb-122">Instead of each collection having a count of one, each collection has a count of two!</span></span> <span data-ttu-id="900cb-123">Das liegt daran, dass jedes `Aquarium` seinen `Fish` der Standardwertauflistung hinzugefügt hat, die das Ergebnis eines einzelnen Konstruktoraufrufs in den Metadaten ist und daher für alle Instanzen freigegeben ist.</span><span class="sxs-lookup"><span data-stu-id="900cb-123">This is because each `Aquarium` added its `Fish` to the default value collection, which resulted from a single constructor call in the metadata and is therefore shared between all instances.</span></span> <span data-ttu-id="900cb-124">Diese Situation ist so gut wie nie erwünscht.</span><span class="sxs-lookup"><span data-stu-id="900cb-124">This situation is almost never what you want.</span></span>  
  
 <span data-ttu-id="900cb-125">Zur Behebung des Problems müssen Sie den Abhängigkeitseigenschaftswert der Auflistung auf eine eindeutige Instanz als Teil des Klassenkonstruktoraufrufs zurücksetzen.</span><span class="sxs-lookup"><span data-stu-id="900cb-125">To correct this problem, you must reset the collection dependency property value to a unique instance, as part of the class constructor call.</span></span> <span data-ttu-id="900cb-126">Da die-Eigenschaft eine schreibgeschützte Abhängigkeits Eigenschaft ist, verwenden Sie die- <xref:System.Windows.DependencyObject.SetValue%28System.Windows.DependencyPropertyKey%2CSystem.Object%29> Methode, um Sie mithilfe von festzulegen, auf die <xref:System.Windows.DependencyPropertyKey> nur innerhalb der-Klasse zugegriffen werden kann.</span><span class="sxs-lookup"><span data-stu-id="900cb-126">Because the property is a read-only dependency property, you use the <xref:System.Windows.DependencyObject.SetValue%28System.Windows.DependencyPropertyKey%2CSystem.Object%29> method to set it, using the <xref:System.Windows.DependencyPropertyKey> that is only accessible within the class.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#CollectionProblemCtor](~/samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page4.xaml.cs#collectionproblemctor)]
 [!code-vb[PropertiesOvwSupport#CollectionProblemCtor](~/samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page4.xaml.vb#collectionproblemctor)]  
  
 <span data-ttu-id="900cb-127">Bei einer erneuten Ausführung des Testcodes wären die Ergebnisse nun eher wie erwartet, da jedes `Aquarium` seine eigene eindeutige Auflistung unterstützen würde.</span><span class="sxs-lookup"><span data-stu-id="900cb-127">Now, if you ran that same test code again, you could see more expected results, where each `Aquarium` supported its own unique collection.</span></span>  
  
 <span data-ttu-id="900cb-128">Dieses Muster wäre geringfügig abgewandelt, wenn Sie die Auflistungseigenschaft mit Lese-/Schreibzugriff wählen würden.</span><span class="sxs-lookup"><span data-stu-id="900cb-128">There would be a slight variation on this pattern if you chose to have your collection property be read-write.</span></span> <span data-ttu-id="900cb-129">In diesem Fall könnten Sie den Public-Set-Accessor vom Konstruktor aufrufen, um die Initialisierung durchzuführen, die nach wie vor die nicht Schlüssel Signatur von <xref:System.Windows.DependencyObject.SetValue%28System.Windows.DependencyProperty%2CSystem.Object%29> innerhalb des Set-Wrappers mit einem öffentlichen <xref:System.Windows.DependencyProperty> Bezeichner aufruft.</span><span class="sxs-lookup"><span data-stu-id="900cb-129">In that case, you could call the public set accessor from the constructor to do the initialization, which would still be calling the nonkey signature of <xref:System.Windows.DependencyObject.SetValue%28System.Windows.DependencyProperty%2CSystem.Object%29> within your set wrapper, using a public <xref:System.Windows.DependencyProperty> identifier.</span></span>  
  
## <a name="reporting-binding-value-changes-from-collection-properties"></a><span data-ttu-id="900cb-130">Melden von Bindungswertänderungen durch Auflistungseigenschaften</span><span class="sxs-lookup"><span data-stu-id="900cb-130">Reporting Binding Value Changes from Collection Properties</span></span>  
 <span data-ttu-id="900cb-131">Eine Auflistungseigenschaft, die selbst eine Abhängigkeitseigenschaft ist, meldet nicht automatisch Änderungen an die ihr untergeordneten Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="900cb-131">A collection property that is itself a dependency property does not automatically report changes to its subproperties.</span></span> <span data-ttu-id="900cb-132">Wenn Sie in einer Auflistung Bindungen erstellen, kann möglicherweise das Melden von Änderungen durch die Bindung verhindert werden, wodurch einige Datenbindungsszenarios ungültig gemacht werden können.</span><span class="sxs-lookup"><span data-stu-id="900cb-132">If you are creating bindings into a collection, this can prevent the binding from reporting changes, thus invalidating some data binding scenarios.</span></span> <span data-ttu-id="900cb-133">Wenn Sie jedoch den Sammlungstyp <xref:System.Windows.FreezableCollection%601> als Auflistungstyp verwenden, werden Änderungen der untergeordneten Eigenschaft an enthaltene Elemente in der Auflistung ordnungsgemäß gemeldet, und die Bindung funktioniert wie erwartet.</span><span class="sxs-lookup"><span data-stu-id="900cb-133">However, if you use the collection type <xref:System.Windows.FreezableCollection%601> as your collection type, then subproperty changes to contained elements in the collection are properly reported, and binding works as expected.</span></span>  
  
 <span data-ttu-id="900cb-134">Um die Bindung von untergeordneten Eigenschaften in einer Auflistung von Abhängigkeits Objekten zu aktivieren, erstellen Sie die Auflistungs Eigenschaft als Typ <xref:System.Windows.FreezableCollection%601> mit einer Typeinschränkung für diese Auflistung in eine beliebige <xref:System.Windows.DependencyObject> abgeleitete Klasse.</span><span class="sxs-lookup"><span data-stu-id="900cb-134">To enable subproperty binding in a dependency object collection, create the collection property as type <xref:System.Windows.FreezableCollection%601>, with a type constraint for that collection to any <xref:System.Windows.DependencyObject> derived class.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="900cb-135">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="900cb-135">See also</span></span>

- <xref:System.Windows.FreezableCollection%601>
- [<span data-ttu-id="900cb-136">XAML- und benutzerdefinierte Klassen für WPF</span><span class="sxs-lookup"><span data-stu-id="900cb-136">XAML and Custom Classes for WPF</span></span>](xaml-and-custom-classes-for-wpf.md)
- [<span data-ttu-id="900cb-137">Übersicht über die Datenbindung</span><span class="sxs-lookup"><span data-stu-id="900cb-137">Data Binding Overview</span></span>](/dotnet/desktop-wpf/data/data-binding-overview)
- [<span data-ttu-id="900cb-138">Übersicht über Abhängigkeitseigenschaften</span><span class="sxs-lookup"><span data-stu-id="900cb-138">Dependency Properties Overview</span></span>](dependency-properties-overview.md)
- [<span data-ttu-id="900cb-139">Benutzerdefinierte Abhängigkeits Eigenschaften</span><span class="sxs-lookup"><span data-stu-id="900cb-139">Custom Dependency Properties</span></span>](custom-dependency-properties.md)
- [<span data-ttu-id="900cb-140">Metadaten für Abhängigkeitseigenschaften</span><span class="sxs-lookup"><span data-stu-id="900cb-140">Dependency Property Metadata</span></span>](dependency-property-metadata.md)
