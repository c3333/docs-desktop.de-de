---
title: 'Gewusst wie: Ermitteln, ob ein Druckauftrag zu dieser Tageszeit gedruckt werden kann'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print queues [WPF], timing
- printers [WPF], availability
- print jobs [WPF], timing
ms.assetid: 7e9c8ec1-abf6-4b3d-b1c6-33b35d3c4063
ms.openlocfilehash: 859dc75169e443d07361951692a428507886fa2e
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/09/2020
ms.locfileid: "96977587"
---
# <a name="how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day"></a><span data-ttu-id="1514f-102">Gewusst wie: Ermitteln, ob ein Druckauftrag zu dieser Tageszeit gedruckt werden kann</span><span class="sxs-lookup"><span data-stu-id="1514f-102">How to: Discover Whether a Print Job Can Be Printed At This Time of Day</span></span>
<span data-ttu-id="1514f-103">Druck Warteschlangen sind nicht immer für 24 Stunden pro Tag verfügbar.</span><span class="sxs-lookup"><span data-stu-id="1514f-103">Print queues are not always available for 24 hours a day.</span></span> <span data-ttu-id="1514f-104">Sie verfügen über Start-und Endzeit Eigenschaften, die festgelegt werden können, um Sie zu bestimmten Tageszeiten nicht verfügbar zu machen.</span><span class="sxs-lookup"><span data-stu-id="1514f-104">They have start and end time properties that can be set to make them unavailable at certain times of day.</span></span> <span data-ttu-id="1514f-105">Diese Funktion kann z. b. verwendet werden, um einen Drucker für die ausschließliche Verwendung einer bestimmten Abteilung nach 5 Uhr zu reservieren.</span><span class="sxs-lookup"><span data-stu-id="1514f-105">This feature can be used, for example, to reserve a printer for the exclusive use of a certain department after 5 P.M..</span></span> <span data-ttu-id="1514f-106">Diese Abteilung hätte eine andere Warteschlange als die von anderen Abteilungen verwendete Warteschlange.</span><span class="sxs-lookup"><span data-stu-id="1514f-106">That department would have a different queue servicing the printer than other departments use.</span></span> <span data-ttu-id="1514f-107">Die Warteschlange für die anderen Abteilungen ist so eingestellt, dass Sie nach 5 Uhr nicht verfügbar ist, während die Warteschlange für die bevorzugte Abteilung jederzeit als verfügbar festgelegt werden kann.</span><span class="sxs-lookup"><span data-stu-id="1514f-107">The queue for the other departments would be set to be unavailable after 5 P.M., while queue for the favored department could be set to be available at all times.</span></span>  
  
 <span data-ttu-id="1514f-108">Darüber hinaus können Druckaufträge selbst so festgelegt werden, dass Sie nur innerhalb eines angegebenen Zeitraums gedruckt werden können.</span><span class="sxs-lookup"><span data-stu-id="1514f-108">Moreover, print jobs themselves can be set to be printable only within a specified span of time.</span></span>  
  
 <span data-ttu-id="1514f-109">Die <xref:System.Printing.PrintQueue> Klassen und, die <xref:System.Printing.PrintSystemJobInfo> in den APIs von Microsoft .NET Framework verfügbar gemacht werden, bieten eine Möglichkeit zur Remote Überprüfung, ob ein angegebener Druckauftrag zum aktuellen Zeitpunkt für eine bestimmte Warteschlange gedruckt werden kann.</span><span class="sxs-lookup"><span data-stu-id="1514f-109">The <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> classes exposed in the APIs of Microsoft .NET Framework provide a means for remotely checking whether a given print job can print on a given queue at the current time.</span></span>  
  
## <a name="example"></a><span data-ttu-id="1514f-110">Beispiel</span><span class="sxs-lookup"><span data-stu-id="1514f-110">Example</span></span>  
 <span data-ttu-id="1514f-111">Das folgende Beispiel zeigt ein Beispiel, mit dem Probleme mit einem Druckauftrag diagnostiziert werden können.</span><span class="sxs-lookup"><span data-stu-id="1514f-111">The example below is a sample that can diagnose problems with a print job.</span></span>  
  
 <span data-ttu-id="1514f-112">Für diese Art von Funktion gibt es die folgenden zwei Hauptschritte:</span><span class="sxs-lookup"><span data-stu-id="1514f-112">There are two major steps for this kind of function as follows.</span></span>  
  
1. <span data-ttu-id="1514f-113">Lesen Sie die <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> -Eigenschaft und die-Eigenschaft <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> des <xref:System.Printing.PrintQueue> , um zu bestimmen, ob die aktuelle Zeit zwischen Ihnen liegt.</span><span class="sxs-lookup"><span data-stu-id="1514f-113">Read the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintQueue> to determine whether the current time is between them.</span></span>  
  
2. <span data-ttu-id="1514f-114">Lesen Sie die <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> -Eigenschaft und die-Eigenschaft <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> des <xref:System.Printing.PrintSystemJobInfo> , um zu bestimmen, ob die aktuelle Zeit zwischen Ihnen liegt.</span><span class="sxs-lookup"><span data-stu-id="1514f-114">Read the <xref:System.Printing.PrintSystemJobInfo.StartTimeOfDay%2A> and <xref:System.Printing.PrintSystemJobInfo.UntilTimeOfDay%2A> properties of the <xref:System.Printing.PrintSystemJobInfo> to determine whether the current time is between them.</span></span>  
  
 <span data-ttu-id="1514f-115">Allerdings entstehen Komplikationen aufgrund der Tatsache, dass es sich bei diesen Eigenschaften nicht um <xref:System.DateTime> Objekte handelt.</span><span class="sxs-lookup"><span data-stu-id="1514f-115">But complications arise from the fact that these properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="1514f-116">Stattdessen handelt es sich um <xref:System.Int32> Objekte, die die Tageszeit als Anzahl von Minuten seit Mitternacht Ausdrücken.</span><span class="sxs-lookup"><span data-stu-id="1514f-116">Instead they are <xref:System.Int32> objects that express the time of day as the number of minutes since midnight.</span></span> <span data-ttu-id="1514f-117">Außerdem ist dies nicht Mitternacht in der aktuellen Zeitzone, sondern Mitternacht UTC (koordinierte Weltzeit).</span><span class="sxs-lookup"><span data-stu-id="1514f-117">Moreover, this is not midnight in the current time zone, but midnight UTC (Coordinated Universal Time).</span></span>  
  
 <span data-ttu-id="1514f-118">Im ersten Codebeispiel wird die statische Methode **ReportQueueAndJobAvailability** dargestellt, der ein weitergegeben wird, <xref:System.Printing.PrintSystemJobInfo> und Hilfsmethoden werden aufgerufen, um zu bestimmen, ob der Auftrag zum aktuellen Zeitpunkt gedruckt werden kann, und andernfalls, wenn er nicht gedruckt werden kann.</span><span class="sxs-lookup"><span data-stu-id="1514f-118">The first code example presents the static method **ReportQueueAndJobAvailability**, which is passed a <xref:System.Printing.PrintSystemJobInfo> and calls helper methods to determine whether the job can print at the current time and, if not, when it can print.</span></span> <span data-ttu-id="1514f-119">Beachten Sie, dass ein <xref:System.Printing.PrintQueue> nicht an die-Methode übermittelt wird.</span><span class="sxs-lookup"><span data-stu-id="1514f-119">Notice that a <xref:System.Printing.PrintQueue> is not passed to the method.</span></span> <span data-ttu-id="1514f-120">Dies liegt daran, dass der <xref:System.Printing.PrintSystemJobInfo> einen Verweis auf die Warteschlange in der- <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> Eigenschaft enthält.</span><span class="sxs-lookup"><span data-stu-id="1514f-120">This is because the <xref:System.Printing.PrintSystemJobInfo> includes a reference to the queue in its <xref:System.Printing.PrintSystemJobInfo.HostingPrintQueue%2A> property.</span></span>  
  
 <span data-ttu-id="1514f-121">Die untergeordneten Methoden enthalten die überladene **ReportAvailabilityAtThisTime** -Methode, die entweder einen <xref:System.Printing.PrintQueue> oder einen <xref:System.Printing.PrintSystemJobInfo> als Parameter annehmen kann.</span><span class="sxs-lookup"><span data-stu-id="1514f-121">The subordinate methods include the overloaded **ReportAvailabilityAtThisTime** method which can take either a <xref:System.Printing.PrintQueue> or a <xref:System.Printing.PrintSystemJobInfo> as a parameter.</span></span> <span data-ttu-id="1514f-122">Es ist auch ein **TimeConverter. converttolocalhumanread abletime**-Wert vorhanden.</span><span class="sxs-lookup"><span data-stu-id="1514f-122">There is also a **TimeConverter.ConvertToLocalHumanReadableTime**.</span></span> <span data-ttu-id="1514f-123">Alle diese Methoden werden im folgenden erläutert.</span><span class="sxs-lookup"><span data-stu-id="1514f-123">All of these methods are discussed below.</span></span>  
  
 <span data-ttu-id="1514f-124">Die Methode **ReportQueueAndJobAvailability** prüft zunächst, ob die Warteschlange oder der Druckauftrag zu diesem Zeitpunkt nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="1514f-124">The **ReportQueueAndJobAvailability** method begins by checking to see if either the queue or the print job is unavailable at this time.</span></span> <span data-ttu-id="1514f-125">Wenn eine der beiden Optionen nicht verfügbar ist, wird überprüft, ob die Warteschlange nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="1514f-125">If either of them is unavailable, it then checks to see if the queue unavailable.</span></span> <span data-ttu-id="1514f-126">Wenn Sie nicht verfügbar ist, meldet die Methode diesen Fakt und die Uhrzeit, zu der die Warteschlange wieder verfügbar wird.</span><span class="sxs-lookup"><span data-stu-id="1514f-126">If it is not available, then the method reports this fact and the time when the queue will become available again.</span></span> <span data-ttu-id="1514f-127">Anschließend wird der Auftrag überprüft, und wenn er nicht verfügbar ist, meldet er die nächste Zeitspanne, zu der er gedruckt werden kann.</span><span class="sxs-lookup"><span data-stu-id="1514f-127">It then checks the job and if it is unavailable, it reports the next time span when it when it can print.</span></span> <span data-ttu-id="1514f-128">Schließlich meldet die-Methode die früheste Uhrzeit, zu der der Auftrag drucken kann.</span><span class="sxs-lookup"><span data-stu-id="1514f-128">Finally, the method reports the earliest time when the job can print.</span></span> <span data-ttu-id="1514f-129">Dies ist das spätere zwei fache.</span><span class="sxs-lookup"><span data-stu-id="1514f-129">This is the later of following two times.</span></span>  
  
- <span data-ttu-id="1514f-130">Der Zeitpunkt, zu dem die Druck Warteschlange als nächstes verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="1514f-130">The time when the print queue is next available.</span></span>  
  
- <span data-ttu-id="1514f-131">Der Zeitpunkt, zu dem der Druckauftrag als nächstes verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="1514f-131">The time when the print job is next available.</span></span>  
  
 <span data-ttu-id="1514f-132">Beim Melden der Tageszeiten <xref:System.DateTime.ToShortTimeString%2A> wird auch die-Methode aufgerufen, da diese Methode die Jahre, Monate und Tage der Ausgabe unterdrückt.</span><span class="sxs-lookup"><span data-stu-id="1514f-132">When reporting times of day, the <xref:System.DateTime.ToShortTimeString%2A> method is also called because this method suppresses the years, months, and days from the output.</span></span> <span data-ttu-id="1514f-133">Die Verfügbarkeit einer Druck Warteschlange oder eines Druckauftrags kann nicht auf bestimmte Jahre, Monate oder Tage beschränkt werden.</span><span class="sxs-lookup"><span data-stu-id="1514f-133">You cannot restrict the availability of either a print queue or a print job to particular years, months, or days.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#reportqueueandjobavailability)]
 [!code-csharp[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#reportqueueandjobavailability)]
 [!code-vb[DiagnoseProblematicPrintJob#ReportQueueAndJobAvailability](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#reportqueueandjobavailability)]  
  
 <span data-ttu-id="1514f-134">Die zwei über Ladungen der **ReportAvailabilityAtThisTime** -Methode sind mit Ausnahme des an Sie übergebenen Typs identisch, sodass nur die- <xref:System.Printing.PrintQueue> Version unten dargestellt wird.</span><span class="sxs-lookup"><span data-stu-id="1514f-134">The two overloads of the **ReportAvailabilityAtThisTime** method are identical except for the type passed to them, so only the <xref:System.Printing.PrintQueue> version is presented below.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="1514f-135">Die Tatsache, dass die Methoden mit Ausnahme des Typs identisch sind, wirft die Frage, warum das Beispiel keine generische Methode " **ReportAvailabilityAtThisTime \<T>**" erstellt.</span><span class="sxs-lookup"><span data-stu-id="1514f-135">The fact that the methods are identical except for type raises the question of why the sample does not create a generic method **ReportAvailabilityAtThisTime\<T>**.</span></span> <span data-ttu-id="1514f-136">Der Grund hierfür ist, dass eine solche Methode auf eine Klasse beschränkt werden muss, die die Eigenschaften **StartTimeOfDay** und **UntilTimeOfDay** hat, die von der-Methode aufgerufen werden, aber eine generische Methode kann nur auf eine einzelne Klasse eingeschränkt werden, und die einzige Klasse, die sowohl für <xref:System.Printing.PrintQueue> als auch <xref:System.Printing.PrintSystemJobInfo> in der Vererbungs Struktur gilt, <xref:System.Printing.PrintSystemObject> verfügt über keine derartigen Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="1514f-136">The reason is that such a method would have to be restricted to a class that has the **StartTimeOfDay** and **UntilTimeOfDay** properties that the method calls, but a generic method can only be restricted to a single class and the only class common to both <xref:System.Printing.PrintQueue> and <xref:System.Printing.PrintSystemJobInfo> in the inheritance tree is <xref:System.Printing.PrintSystemObject> which has no such properties.</span></span>  
  
 <span data-ttu-id="1514f-137">Die **ReportAvailabilityAtThisTime** -Methode (im folgenden Codebeispiel dargestellt) beginnt mit dem Initialisieren einer <xref:System.Boolean> Sentinel-Variablen in `true` .</span><span class="sxs-lookup"><span data-stu-id="1514f-137">The **ReportAvailabilityAtThisTime** method (presented in the code example below) begins by initializing a <xref:System.Boolean> sentinel variable to `true`.</span></span> <span data-ttu-id="1514f-138">Sie wird auf zurückgesetzt `false` , wenn die Warteschlange nicht verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="1514f-138">It will be reset to `false`, if the queue is not available.</span></span>  
  
 <span data-ttu-id="1514f-139">Als nächstes überprüft die Methode, ob die Start-und "Until"-Zeiten identisch sind.</span><span class="sxs-lookup"><span data-stu-id="1514f-139">Next, the method checks to see if the start and "until" times are identical.</span></span> <span data-ttu-id="1514f-140">Wenn dies der Fall ist, ist die Warteschlange immer verfügbar, sodass die Methode zurückgibt `true` .</span><span class="sxs-lookup"><span data-stu-id="1514f-140">If they are, the queue is always available, so the method returns `true`.</span></span>  
  
 <span data-ttu-id="1514f-141">Wenn die Warteschlange nicht ständig verfügbar ist, verwendet die-Methode die statische- <xref:System.DateTime.UtcNow%2A> Eigenschaft, um die aktuelle Zeit als-Objekt zu erhalten <xref:System.DateTime> .</span><span class="sxs-lookup"><span data-stu-id="1514f-141">If the queue is not available all the time, the method uses the static <xref:System.DateTime.UtcNow%2A> property to get the current time as a <xref:System.DateTime> object.</span></span> <span data-ttu-id="1514f-142">(Lokale Zeit ist nicht erforderlich, da die <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> -Eigenschaft und die-Eigenschaft <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> selbst in UTC-Zeit sind.)</span><span class="sxs-lookup"><span data-stu-id="1514f-142">(We do not need local time because the <xref:System.Printing.PrintQueue.StartTimeOfDay%2A> and <xref:System.Printing.PrintQueue.UntilTimeOfDay%2A> properties are themselves in UTC time.)</span></span>  
  
 <span data-ttu-id="1514f-143">Diese beiden Eigenschaften sind jedoch keine- <xref:System.DateTime> Objekte.</span><span class="sxs-lookup"><span data-stu-id="1514f-143">However, these two properties are not <xref:System.DateTime> objects.</span></span> <span data-ttu-id="1514f-144">Sie <xref:System.Int32> Ausdrücken die Zeit als Anzahl von Minuten nach-UTC-Mitternacht.</span><span class="sxs-lookup"><span data-stu-id="1514f-144">They are <xref:System.Int32>s expressing the time as the number of minutes-after-UTC-midnight.</span></span> <span data-ttu-id="1514f-145">Wir müssen also unser <xref:System.DateTime> Objekt in Minuten nach Mitternacht konvertieren.</span><span class="sxs-lookup"><span data-stu-id="1514f-145">So we do have to convert our <xref:System.DateTime> object to minutes-after-midnight.</span></span> <span data-ttu-id="1514f-146">Wenn dies der Fall ist, prüft die Methode einfach, ob "Now" zwischen den Start-und "Until"-Zeiten der Warteschlange liegt, und legt den Sentinel auf "false" fest, wenn "Now" nicht zwischen den beiden Vorkommen liegt, und gibt den Sentinel zurück.</span><span class="sxs-lookup"><span data-stu-id="1514f-146">When that is done, the method simply checks to see whether "now" is between the queue's start and "until" times, sets the sentinel to false if "now" is not between the two times, and returns the sentinel.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#printqueuestartuntil)]
 [!code-csharp[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#printqueuestartuntil)]
 [!code-vb[DiagnoseProblematicPrintJob#PrintQueueStartUntil](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#printqueuestartuntil)]  
  
 <span data-ttu-id="1514f-147">Die **TimeConverter. converttolocalhumanleabletime** -Methode (im folgenden Codebeispiel dargestellt) verwendet keine Methoden, die mit Microsoft .NET Framework eingeführt wurden, sodass die Diskussion kurz ist.</span><span class="sxs-lookup"><span data-stu-id="1514f-147">The **TimeConverter.ConvertToLocalHumanReadableTime** method (presented in the code example below) does not use any methods introduced with Microsoft .NET Framework, so the discussion is brief.</span></span> <span data-ttu-id="1514f-148">Die Methode verfügt über einen Double-Konvertierungs Task: Sie muss eine ganze Zahl sein, die Minuten nach Mitternacht ausdrückt, und Sie muss in eine lesbare Zeit konvertiert werden, und Sie muss in die Ortszeit konvertiert werden.</span><span class="sxs-lookup"><span data-stu-id="1514f-148">The method has a double conversion task: it must take an integer expressing minutes-after-midnight and convert it to a human-readable time and it must convert this to the local time.</span></span> <span data-ttu-id="1514f-149">Dies wird erreicht, indem zuerst ein <xref:System.DateTime> -Objekt erstellt wird, das auf Mitternacht UTC festgelegt ist. Anschließend wird die- <xref:System.DateTime.AddMinutes%2A> Methode verwendet, um die Minuten hinzuzufügen, die an die-Methode weitergegeben wurden.</span><span class="sxs-lookup"><span data-stu-id="1514f-149">It accomplishes this by first creating a <xref:System.DateTime> object that is set to midnight UTC and then it uses the <xref:System.DateTime.AddMinutes%2A> method to add the minutes that were passed to the method.</span></span> <span data-ttu-id="1514f-150">Dadurch wird <xref:System.DateTime> die ursprüngliche Zeit zurückgegeben, die an die-Methode übermittelt wurde.</span><span class="sxs-lookup"><span data-stu-id="1514f-150">This returns a new <xref:System.DateTime> expressing the original time that was passed to the method.</span></span> <span data-ttu-id="1514f-151">Die <xref:System.DateTime.ToLocalTime%2A> Methode konvertiert diese dann in die lokale Zeit.</span><span class="sxs-lookup"><span data-stu-id="1514f-151">The <xref:System.DateTime.ToLocalTime%2A> method then converts this to local time.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#timeconverter)]
 [!code-csharp[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#timeconverter)]
 [!code-vb[DiagnoseProblematicPrintJob#TimeConverter](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#timeconverter)]  
  
## <a name="see-also"></a><span data-ttu-id="1514f-152">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="1514f-152">See also</span></span>

- <xref:System.DateTime>
- <xref:System.Printing.PrintSystemJobInfo>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="1514f-153">Dokumente in WPF</span><span class="sxs-lookup"><span data-stu-id="1514f-153">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="1514f-154">Übersicht über das Drucken</span><span class="sxs-lookup"><span data-stu-id="1514f-154">Printing Overview</span></span>](printing-overview.md)
