---
title: Übersicht über nicht verwaltete apps
ms.date: 03/30/2017
ms.topic: overview
helpviewer_keywords:
- COM [Windows Forms]
- Windows Forms, unmanaged
- COM interop
- ActiveX controls [Windows Forms], about ActiveX controls
- Windows Forms, interop
ms.assetid: 0a26d99d-8135-4895-8760-c9a2b5f67f14
ms.openlocfilehash: 48599e11a99216d27029256d8ff4c7d1d4692c03
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/09/2020
ms.locfileid: "96975813"
---
# <a name="windows-forms-and-unmanaged-applications-overview"></a><span data-ttu-id="49b38-102">Übersicht über Windows Forms und nicht verwaltete Anwendungen</span><span class="sxs-lookup"><span data-stu-id="49b38-102">Windows Forms and Unmanaged Applications Overview</span></span>

<span data-ttu-id="49b38-103">Windows Forms-Anwendungen und-Steuerelemente können mit einigen Einschränkungen mit nicht verwalteten Anwendungen zusammenarbeiten.</span><span class="sxs-lookup"><span data-stu-id="49b38-103">Windows Forms applications and controls can interoperate with unmanaged applications, with some caveats.</span></span> <span data-ttu-id="49b38-104">In den folgenden Abschnitten werden die von Windows Forms-Anwendungen und -Steuerelementen unterstützten und nicht unterstützten Szenarien und Konfigurationen beschrieben.</span><span class="sxs-lookup"><span data-stu-id="49b38-104">The following sections describe the scenarios and configurations that Windows Forms applications and controls support and those that they do not support.</span></span>  
  
## <a name="windows-forms-controls-and-activex-applications"></a><span data-ttu-id="49b38-105">Windows Forms-Steuerelemente und ActiveX-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="49b38-105">Windows Forms Controls and ActiveX Applications</span></span>  

 <span data-ttu-id="49b38-106">Mit Ausnahme von Microsoft Internet Explorer und Microsoft Foundation Classes (MFC) werden Windows Forms-Steuerelemente in Anwendungen, die auf das Hosting von ActiveX-Steuerelementen ausgelegt sind, nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="49b38-106">With the exception of Microsoft Internet Explorer and Microsoft Foundation Classes (MFC), Windows Forms controls are not supported in applications designed to host ActiveX controls.</span></span> <span data-ttu-id="49b38-107">Andere Anwendungen und Entwicklungstools, die ActiveX-Steuerelemente hosten können, einschließlich der ActiveX-Testcontainer aus früheren Visual Studio-Versionen als Visual Studio .NET 2003, sind keine unterstützten Hosts für Windows Forms-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="49b38-107">Other applications and development tools that are capable of hosting ActiveX controls, including the ActiveX test containers from versions of Visual Studio that are earlier than Visual Studio .NET 2003, are not supported hosts for Windows Forms controls.</span></span>  
  
 <span data-ttu-id="49b38-108">Diese Einschränkungen gelten auch für die Verwendung von Windows Forms-Steuerelementen mithilfe von COM-Interop (Component Object Model).</span><span class="sxs-lookup"><span data-stu-id="49b38-108">These constraints also apply to the use of Windows Forms controls through Component Object Model COM interop.</span></span> <span data-ttu-id="49b38-109">Die Verwendung eines Windows Forms-Steuerelements mithilfe eines COM Callable Wrappers (CCW) wird nur in Internet Explorer unterstützt.</span><span class="sxs-lookup"><span data-stu-id="49b38-109">The use of a Windows Forms control through a COM callable wrapper (CCW) is supported only in Internet Explorer.</span></span> <span data-ttu-id="49b38-110">Weitere Informationen zu COM-Interop finden Sie unter</span><span class="sxs-lookup"><span data-stu-id="49b38-110">For more information about COM interop, see</span></span>  
  
 <span data-ttu-id="49b38-111">[COM-Interop](/dotnet/visual-basic/programming-guide/com-interop/index).</span><span class="sxs-lookup"><span data-stu-id="49b38-111">[COM Interop](/dotnet/visual-basic/programming-guide/com-interop/index).</span></span>  
  
 <span data-ttu-id="49b38-112">Die folgende Tabelle zeigt die verfügbare Unterstützung für ActiveX-Hosting für Windows Forms-Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="49b38-112">The following table shows the available ActiveX hosting support for Windows Forms controls.</span></span>  
  
|<span data-ttu-id="49b38-113">Windows Forms-Version</span><span class="sxs-lookup"><span data-stu-id="49b38-113">Windows Forms version</span></span>|<span data-ttu-id="49b38-114">Unterstützung</span><span class="sxs-lookup"><span data-stu-id="49b38-114">Support</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="49b38-115">.NET Framework Version 1.0</span><span class="sxs-lookup"><span data-stu-id="49b38-115">.NET Framework version 1.0</span></span>|<span data-ttu-id="49b38-116">Internet Explorer 5.01 und höhere Versionen</span><span class="sxs-lookup"><span data-stu-id="49b38-116">Internet Explorer 5.01 and later versions</span></span>|  
|<span data-ttu-id="49b38-117">.NET Framework Version 1.1 und höher</span><span class="sxs-lookup"><span data-stu-id="49b38-117">.NET Framework version 1.1 and later</span></span>|<span data-ttu-id="49b38-118">Internet Explorer 5.01 und höhere Versionen</span><span class="sxs-lookup"><span data-stu-id="49b38-118">Internet Explorer 5.01 and later versions</span></span><br /><br /> <span data-ttu-id="49b38-119">Microsoft Foundation Classes (MFC) 7.0 und höher</span><span class="sxs-lookup"><span data-stu-id="49b38-119">Microsoft Foundation Classes (MFC) 7.0 and later</span></span>|  
  
## <a name="hosting-windows-forms-components-as-activex-controls"></a><span data-ttu-id="49b38-120">Hosten von Windows Forms-Komponenten als ActiveX-Steuerelemente</span><span class="sxs-lookup"><span data-stu-id="49b38-120">Hosting Windows Forms components as ActiveX controls</span></span>  

 <span data-ttu-id="49b38-121">In .NET Framework 1.1 wurde die Unterstützung auf MFC 7.0 und höhere Versionen erweitert.</span><span class="sxs-lookup"><span data-stu-id="49b38-121">In the .NET Framework 1.1, support was extended to include MFC 7.0 and later versions.</span></span> <span data-ttu-id="49b38-122">Diese Unterstützung umfasst alle Container, die mit dem ActiveX-Steuerelementcontainer aus MFC 7.0 und höher vollständig kompatibel sind.</span><span class="sxs-lookup"><span data-stu-id="49b38-122">This support includes any container that is fully compatible with the MFC 7.0 and later ActiveX control container.</span></span>  
  
 <span data-ttu-id="49b38-123">Die Registrierung von Windows Forms-Steuerelementen als ActiveX-Steuerelementen wird jedoch nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="49b38-123">However, registration of Windows Forms controls as ActiveX controls is not supported.</span></span> <span data-ttu-id="49b38-124">Ebenfalls wird das Aufrufen der `com.ms.win32.Ole32.CoCreateInstance` -Methode für Windows Forms-Steuerelementen nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="49b38-124">Also, calling the `com.ms.win32.Ole32.CoCreateInstance` method for Windows Forms controls is not supported.</span></span> <span data-ttu-id="49b38-125">Nur die verwaltete Aktivierung von Windows Forms-Steuerelementen wird unterstützt.</span><span class="sxs-lookup"><span data-stu-id="49b38-125">Only managed activation of Windows Forms controls is supported.</span></span> <span data-ttu-id="49b38-126">Nachdem Sie ein Windows Forms-Steuerelement erstellt haben, können Sie es in einer MFC-Anwendung hosten, wie bei einem ActiveX-Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="49b38-126">Once you create a Windows Forms control, you can host it in an MFC application just as with an ActiveX control.</span></span>  
  
 <span data-ttu-id="49b38-127">Um Windows Forms-Steuerelemente in Ihrer nicht verwalteten Anwendung zu verwenden, müssen Sie entweder die CLR mithilfe der Hosting-APIs der nicht verwalteten CLR hosten oder die C++-Interop-Funktionen verwenden.</span><span class="sxs-lookup"><span data-stu-id="49b38-127">To use Windows Forms controls in your unmanaged application, you must either host the CLR using the unmanaged CLR hosting APIs or use the C++ interop features.</span></span> <span data-ttu-id="49b38-128">Die Verwendung der C++-Interop-Funktionen ist die empfohlene Lösung.</span><span class="sxs-lookup"><span data-stu-id="49b38-128">Using the C++ interop features is the recommended solution.</span></span>  
  
## <a name="windows-forms-in-com-client-applications"></a><span data-ttu-id="49b38-129">Windows Forms in COM-Clientanwendungen</span><span class="sxs-lookup"><span data-stu-id="49b38-129">Windows Forms in COM client applications</span></span>  

 <span data-ttu-id="49b38-130">Wenn Sie ein Windows Form aus eine COM-Clientanwendung öffnen, z. B. einer Visual Basic 6.0-Anwendung oder einer MFC-Anwendung, kann das Formular unerwartetes Verhalten zeigen.</span><span class="sxs-lookup"><span data-stu-id="49b38-130">When you open a Windows Form from a COM client application, such as a Visual Basic 6.0 application or an MFC application, the form may behave unexpectedly.</span></span> <span data-ttu-id="49b38-131">Wenn Sie z. B. die TAB-Taste drücken, wechselt der Fokus nicht von einem Steuerelement zu einem anderen.</span><span class="sxs-lookup"><span data-stu-id="49b38-131">For example, when you press the TAB key, the focus does not change from one control to another control.</span></span> <span data-ttu-id="49b38-132">Wenn Sie die EINGABETASTE drücken, während eine Befehlsschaltfläche den Fokus besitzt, wird das <xref:System.Windows.Forms.Control.Click> -Ereignis der Schaltfläche nicht ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="49b38-132">When you press the ENTER key while a command button has focus, the button's <xref:System.Windows.Forms.Control.Click> event is not raised.</span></span> <span data-ttu-id="49b38-133">Auch bei Tastatureingaben oder Mausaktivitäten kann unerwartetes Verhalten auftreten.</span><span class="sxs-lookup"><span data-stu-id="49b38-133">You may also experience unexpected behavior for keystrokes or mouse activity.</span></span>  
  
 <span data-ttu-id="49b38-134">Dieses Verhalten tritt auf, weil die nicht verwaltete Anwendung nicht die Unterstützung für Nachrichtenschleifen implementiert, die Windows Forms für eine ordnungsgemäße Funktion erfordert.</span><span class="sxs-lookup"><span data-stu-id="49b38-134">This behavior occurs because the unmanaged application does not implement the message loop support that Windows Forms requires to work correctly.</span></span> <span data-ttu-id="49b38-135">Die von der COM-Clientanwendung bereitgestellte Nachrichtenschleife unterscheidet sich grundlegend von der Windows Forms-Nachrichtenschleife.</span><span class="sxs-lookup"><span data-stu-id="49b38-135">The message loop provided by the COM client application is fundamentally different from the Windows Forms message loop.</span></span>  
  
 <span data-ttu-id="49b38-136">Die Nachrichtenschleife einer Anwendung ist eine interne Programmschleife, die Nachrichten aus der Nachrichtenwarteschlange eines Threads abruft, diese übersetzt und dann an die zu behandelnde Anwendung sendet.</span><span class="sxs-lookup"><span data-stu-id="49b38-136">An application's message loop is an internal program loop that retrieves messages from a thread's message queue, translates them, and then sends them to the application to be handled.</span></span> <span data-ttu-id="49b38-137">Die Nachrichtenschleife für ein Windows Form hat nicht dieselbe Architektur wie Nachrichtenschleifen, die von früheren Anwendungen, z. B. Visual Basic 6.0-Anwendungen und MFC-Anwendungen, bereitgestellt werden.</span><span class="sxs-lookup"><span data-stu-id="49b38-137">The message loop for a Windows Form does not have the same architecture as message loops that earlier applications, such as Visual Basic 6.0 applications and MFC applications, provide.</span></span> <span data-ttu-id="49b38-138">Die Windows-Nachrichten, die in der Nachrichtenschleife bereitgestellt werden, werden möglicherweise anders behandelt, als vom Windows Form erwartet.</span><span class="sxs-lookup"><span data-stu-id="49b38-138">The window messages that are posted to the message loop may be handled differently than the Windows Form expects.</span></span> <span data-ttu-id="49b38-139">Daher kann es zu unerwartetem Verhalten kommen.</span><span class="sxs-lookup"><span data-stu-id="49b38-139">Therefore, unexpected behavior may occur.</span></span> <span data-ttu-id="49b38-140">Einige Tastenkombinationen funktionieren möglicherweise nicht, einige Mausaktivitäten funktionieren eventuell nicht, oder einige Ereignisse werden möglicherweise nicht wie erwartet ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="49b38-140">Some keystroke combinations may not work, some mouse activity may not work, or some events may not be raised as expected.</span></span>  
  
## <a name="resolving-interoperability-issues"></a><span data-ttu-id="49b38-141">Beheben von Interoperabilitätsproblemen</span><span class="sxs-lookup"><span data-stu-id="49b38-141">Resolving Interoperability Issues</span></span>  

 <span data-ttu-id="49b38-142">Sie können diese Probleme beheben, indem Sie das Formular in einer .NET Framework-Nachrichten Schleife anzeigen, die mit der-Methode erstellt wird <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="49b38-142">You can resolve these problems by displaying the form on a .NET Framework message loop, which is created by using the <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="49b38-143">Damit ein Windows Form aus einer COM-Clientanwendung heraus ordnungsgemäß funktioniert, müssen Sie es in einer Windows Forms-Nachrichtenschleife ausführen.</span><span class="sxs-lookup"><span data-stu-id="49b38-143">To make a Windows Form work correctly from a COM client application, you must run it on a Windows Forms message loop.</span></span> <span data-ttu-id="49b38-144">Hierzu können Sie einen der folgenden Ansätze verwenden:</span><span class="sxs-lookup"><span data-stu-id="49b38-144">To do this, use one of the following approaches:</span></span>  
  
- <span data-ttu-id="49b38-145">Verwenden Sie die <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> -Methode, um das Windows Form anzuzeigen.</span><span class="sxs-lookup"><span data-stu-id="49b38-145">Use the <xref:System.Windows.Forms.Form.ShowDialog%2A?displayProperty=nameWithType> method to display the Windows Form.</span></span> <span data-ttu-id="49b38-146">Weitere Informationen finden Sie unter [Vorgehensweise: Unterstützen von COM-Interop durch Anzeigen eines Windows Forms mit der ShowDialog-Methode](com-interop-by-displaying-a-windows-form-shadow.md).</span><span class="sxs-lookup"><span data-stu-id="49b38-146">For more information, see [How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method](com-interop-by-displaying-a-windows-form-shadow.md).</span></span>  
  
- <span data-ttu-id="49b38-147">Zeigen Sie jedes Windows Form in einem neuen Thread an.</span><span class="sxs-lookup"><span data-stu-id="49b38-147">Display each Windows Form on a new thread.</span></span> <span data-ttu-id="49b38-148">Weitere Informationen finden Sie unter [Vorgehensweise: Unterstützen von COM-Interop durch Anzeigen jedes Windows Forms in einem eigenen Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span><span class="sxs-lookup"><span data-stu-id="49b38-148">For more information, see [How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="49b38-149">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="49b38-149">See also</span></span>

- [<span data-ttu-id="49b38-150">Windows Forms und nicht verwaltete Anwendungen</span><span class="sxs-lookup"><span data-stu-id="49b38-150">Windows Forms and Unmanaged Applications</span></span>](windows-forms-and-unmanaged-applications.md)
- [<span data-ttu-id="49b38-151">COM-Interop</span><span class="sxs-lookup"><span data-stu-id="49b38-151">COM Interop</span></span>](/dotnet/visual-basic/programming-guide/com-interop/index)
- [<span data-ttu-id="49b38-152">COM-Interoperabilität in .NET Framework-Anwendungen</span><span class="sxs-lookup"><span data-stu-id="49b38-152">COM Interoperability in .NET Framework Applications</span></span>](/dotnet/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications)
- <span data-ttu-id="49b38-153">[Beispiele für COM-Interoperabilität](/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span><span class="sxs-lookup"><span data-stu-id="49b38-153">[COM Interoperability Samples](/previous-versions/visualstudio/visual-studio-2008/cxcz83xf(v=vs.90))</span></span>
- [<span data-ttu-id="49b38-154">Aximp.exe (Windows Forms ActiveX Control Importer-Tool)</span><span class="sxs-lookup"><span data-stu-id="49b38-154">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>](/dotnet/framework/tools/aximp-exe-windows-forms-activex-control-importer)
- [<span data-ttu-id="49b38-155">Verfügbarmachen von .NET Framework-Komponenten in COM</span><span class="sxs-lookup"><span data-stu-id="49b38-155">Exposing .NET Framework Components to COM</span></span>](/dotnet/framework/interop/exposing-dotnet-components-to-co)
- [<span data-ttu-id="49b38-156">Verpacken einer Assembly für COM</span><span class="sxs-lookup"><span data-stu-id="49b38-156">Packaging an Assembly for COM</span></span>](/dotnet/framework/interop/packaging-an-assembly-for-co)
- [<span data-ttu-id="49b38-157">Registrieren von Assemblys bei COM</span><span class="sxs-lookup"><span data-stu-id="49b38-157">Registering Assemblies with COM</span></span>](/dotnet/framework/interop/registering-assemblies-with-co)
- [<span data-ttu-id="49b38-158">Vorgehensweise: Unterstützen von COM-Interop durch Anzeigen eines Windows Forms mit der ShowDialog-Methode</span><span class="sxs-lookup"><span data-stu-id="49b38-158">How to: Support COM Interop by Displaying a Windows Form with the ShowDialog Method</span></span>](com-interop-by-displaying-a-windows-form-shadow.md)
- [<span data-ttu-id="49b38-159">Vorgehensweise: Unterstützen von COM-Interop durch das Anzeigen einzelner Windows Forms in einem eigenen Thread</span><span class="sxs-lookup"><span data-stu-id="49b38-159">How to: Support COM Interop by Displaying Each Windows Form on Its Own Thread</span></span>](how-to-support-com-interop-by-displaying-each-windows-form-on-its-own-thread.md)
