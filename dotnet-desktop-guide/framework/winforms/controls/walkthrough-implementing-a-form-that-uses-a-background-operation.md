---
title: 'Exemplarische Vorgehensweise: Implementieren eines Formulars, das eine Hintergrundoperation verwendet'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- threading [Windows Forms], forms
- BackgroundWorker component
- background tasks
- forms [Windows Forms], multithreading
- threading [Windows Forms], walkthroughs
- forms [Windows Forms], background operations
- threading [Windows Forms], background operations
- background operations
ms.assetid: 4691b796-9200-471a-89c3-ba4c7cc78c03
ms.openlocfilehash: bdd82b0f32f93fbcdd5713bfb9ba9081f653298b
ms.sourcegitcommit: 9f6df084c53a3da0ea657ed0d708a72213683084
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 12/09/2020
ms.locfileid: "96976600"
---
# <a name="walkthrough-implementing-a-form-that-uses-a-background-operation"></a><span data-ttu-id="1f344-102">Exemplarische Vorgehensweise: Implementieren eines Formulars, das eine Hintergrundoperation verwendet</span><span class="sxs-lookup"><span data-stu-id="1f344-102">Walkthrough: Implementing a Form That Uses a Background Operation</span></span>

<span data-ttu-id="1f344-103">Wenn Sie über einen Vorgang verfügen, der viel Zeit in Anspruch nimmt, und Sie nicht möchten, dass die Benutzeroberfläche nicht mehr reagiert oder blockiert wird, können Sie die-Klasse verwenden, <xref:System.ComponentModel.BackgroundWorker> um den Vorgang auf einem anderen Thread auszuführen.</span><span class="sxs-lookup"><span data-stu-id="1f344-103">If you have an operation that will take a long time to complete, and you do not want your user interface (UI) to stop responding or to block, you can use the <xref:System.ComponentModel.BackgroundWorker> class to execute the operation on another thread.</span></span>

<span data-ttu-id="1f344-104">In dieser exemplarischen Vorgehensweise wird veranschaulicht <xref:System.ComponentModel.BackgroundWorker> , wie die-Klasse verwendet wird, um zeitaufwändige Berechnungen "im Hintergrund" auszuführen, während die Benutzeroberfläche weiterhin reaktionsfähig ist.</span><span class="sxs-lookup"><span data-stu-id="1f344-104">This walkthrough illustrates how to use the <xref:System.ComponentModel.BackgroundWorker> class to perform time-consuming computations "in the background," while the user interface remains responsive.</span></span>  <span data-ttu-id="1f344-105">Wenn Sie diese exemplarische Vorgehensweise abgeschlossen haben, verfügen Sie über eine Anwendung, die Fibonacci-Zahlen asynchron berechnet.</span><span class="sxs-lookup"><span data-stu-id="1f344-105">When you are through, you will have an application that computes Fibonacci numbers asynchronously.</span></span> <span data-ttu-id="1f344-106">Obwohl das Berechnen einer großen Fibonacci-Zahl merklich Zeit in Anspruch nimmt, wird der Haupt-UI-Thread nicht von dieser Verzögerung unterbrochen, und das Formular behält während der Berechnung seine Reaktionsfähigkeit.</span><span class="sxs-lookup"><span data-stu-id="1f344-106">Even though computing a large Fibonacci number can take a noticeable amount of time, the main UI thread will not be interrupted by this delay, and the form will be responsive during the calculation.</span></span>

<span data-ttu-id="1f344-107">In dieser exemplarischen Vorgehensweise werden u. a. folgende Aufgaben veranschaulicht:</span><span class="sxs-lookup"><span data-stu-id="1f344-107">Tasks illustrated in this walkthrough include:</span></span>

- <span data-ttu-id="1f344-108">Erstellen einer Windows-basierten Anwendung</span><span class="sxs-lookup"><span data-stu-id="1f344-108">Creating a Windows-based Application</span></span>

- <span data-ttu-id="1f344-109">Erstellen einer <xref:System.ComponentModel.BackgroundWorker> in Ihrem Formular</span><span class="sxs-lookup"><span data-stu-id="1f344-109">Creating a <xref:System.ComponentModel.BackgroundWorker> in Your Form</span></span>

- <span data-ttu-id="1f344-110">Hinzufügen Asynchroner Ereignishandler</span><span class="sxs-lookup"><span data-stu-id="1f344-110">Adding Asynchronous Event Handlers</span></span>

- <span data-ttu-id="1f344-111">Hinzufügen von Statusberichterstellung und Abbruchunterstützung</span><span class="sxs-lookup"><span data-stu-id="1f344-111">Adding Progress Reporting and Support for Cancellation</span></span>

<span data-ttu-id="1f344-112">Eine vollständige Liste des in diesem Beispiel verwendeten Codes finden Sie unter [Vorgehensweise: Implementieren eines Formulars, das eine Hintergrundoperation verwendet](how-to-implement-a-form-that-uses-a-background-operation.md).</span><span class="sxs-lookup"><span data-stu-id="1f344-112">For a complete listing of the code used in this example, see [How to: Implement a Form That Uses a Background Operation](how-to-implement-a-form-that-uses-a-background-operation.md).</span></span>

## <a name="create-a-form-that-uses-a-background-operation"></a><span data-ttu-id="1f344-113">Erstellen eines Formulars, das einen Hintergrund Vorgang verwendet</span><span class="sxs-lookup"><span data-stu-id="1f344-113">Create a form that uses a background operation</span></span>

1. <span data-ttu-id="1f344-114">Erstellen Sie in Visual Studio ein Windows-basiertes Anwendungsprojekt mit dem Namen `BackgroundWorkerExample` (**File**  >  **New**  >  **Project**  >  **Visual c#** oder **Visual Basic**  >  **Classic Desktop**  >  **Windows Forms Anwendung**).</span><span class="sxs-lookup"><span data-stu-id="1f344-114">In Visual Studio, create a Windows-based application project called `BackgroundWorkerExample` (**File** > **New** > **Project** > **Visual C#** or **Visual Basic** > **Classic Desktop** > **Windows Forms Application**).</span></span>

2. <span data-ttu-id="1f344-115">Klicken Sie im **Projektmappen-Explorer** mit der rechten Maustaste auf **Form1**, und wählen Sie im Kontextmenü **Umbenennen** aus.</span><span class="sxs-lookup"><span data-stu-id="1f344-115">In **Solution Explorer**, right-click **Form1** and select **Rename** from the shortcut menu.</span></span> <span data-ttu-id="1f344-116">Ändern Sie den Dateinamen in `FibonacciCalculator`.</span><span class="sxs-lookup"><span data-stu-id="1f344-116">Change the file name to `FibonacciCalculator`.</span></span> <span data-ttu-id="1f344-117">Klicken Sie auf die Schaltfläche **Ja**, wenn Sie gefragt werden, ob alle Verweise auf das Codeelement `Form1` umbenannt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="1f344-117">Click the **Yes** button when you are asked if you want to rename all references to the code element '`Form1`'.</span></span>

3. <span data-ttu-id="1f344-118">Ziehen Sie ein- <xref:System.Windows.Forms.NumericUpDown> Steuerelement aus der **Toolbox** auf das Formular.</span><span class="sxs-lookup"><span data-stu-id="1f344-118">Drag a <xref:System.Windows.Forms.NumericUpDown> control from the **Toolbox** onto the form.</span></span> <span data-ttu-id="1f344-119">Legen <xref:System.Windows.Forms.NumericUpDown.Minimum%2A> Sie die-Eigenschaft auf `1` und die- <xref:System.Windows.Forms.NumericUpDown.Maximum%2A> Eigenschaft auf fest `91` .</span><span class="sxs-lookup"><span data-stu-id="1f344-119">Set the <xref:System.Windows.Forms.NumericUpDown.Minimum%2A> property to `1` and the <xref:System.Windows.Forms.NumericUpDown.Maximum%2A> property to `91`.</span></span>

4. <span data-ttu-id="1f344-120">Fügen Sie <xref:System.Windows.Forms.Button> dem Formular zwei-Steuerelemente hinzu.</span><span class="sxs-lookup"><span data-stu-id="1f344-120">Add two <xref:System.Windows.Forms.Button> controls to the form.</span></span>

5. <span data-ttu-id="1f344-121">Benennen Sie das erste <xref:System.Windows.Forms.Button> Steuerelement `startAsyncButton` um und legen Sie die- <xref:System.Windows.Forms.Control.Text%2A> Eigenschaft auf fest `Start Async`</span><span class="sxs-lookup"><span data-stu-id="1f344-121">Rename the first <xref:System.Windows.Forms.Button> control `startAsyncButton` and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Start Async`.</span></span> <span data-ttu-id="1f344-122">Benennen Sie das zweite <xref:System.Windows.Forms.Button> Steuerelement `cancelAsyncButton` um und legen Sie die- <xref:System.Windows.Forms.Control.Text%2A> Eigenschaft auf fest `Cancel Async` .</span><span class="sxs-lookup"><span data-stu-id="1f344-122">Rename the second <xref:System.Windows.Forms.Button> control `cancelAsyncButton`, and set the <xref:System.Windows.Forms.Control.Text%2A> property to `Cancel Async`.</span></span> <span data-ttu-id="1f344-123">Legen Sie die- <xref:System.Windows.Forms.Control.Enabled%2A> Eigenschaft auf fest `false` .</span><span class="sxs-lookup"><span data-stu-id="1f344-123">Set its <xref:System.Windows.Forms.Control.Enabled%2A> property to `false`.</span></span>

6. <span data-ttu-id="1f344-124">Erstellen Sie einen Ereignishandler für beide Ereignisse der-Steuer <xref:System.Windows.Forms.Button> Elemente <xref:System.Windows.Forms.Control.Click> .</span><span class="sxs-lookup"><span data-stu-id="1f344-124">Create an event handler for both of the <xref:System.Windows.Forms.Button> controls' <xref:System.Windows.Forms.Control.Click> events.</span></span> <span data-ttu-id="1f344-125">Weitere Informationen finden Sie unter [Vorgehensweise: Erstellen von Ereignishandlern mithilfe des Designers](/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="1f344-125">For details, see [How to: Create Event Handlers Using the Designer](/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span></span>

7. <span data-ttu-id="1f344-126">Ziehen <xref:System.Windows.Forms.Label> Sie ein-Steuerelement aus der **Toolbox** auf das Formular, und benennen Sie es um `resultLabel` .</span><span class="sxs-lookup"><span data-stu-id="1f344-126">Drag a <xref:System.Windows.Forms.Label> control from the **Toolbox** onto the form and rename it `resultLabel`.</span></span>

8. <span data-ttu-id="1f344-127">Ziehen Sie ein- <xref:System.Windows.Forms.ProgressBar> Steuerelement aus der **Toolbox** auf das Formular.</span><span class="sxs-lookup"><span data-stu-id="1f344-127">Drag a <xref:System.Windows.Forms.ProgressBar> control from the **Toolbox** onto the form.</span></span>

## <a name="create-a-backgroundworker-with-the-designer"></a><span data-ttu-id="1f344-128">Erstellen eines BackgroundWorker mit dem Designer</span><span class="sxs-lookup"><span data-stu-id="1f344-128">Create a BackgroundWorker with the Designer</span></span>

<span data-ttu-id="1f344-129">Sie können den <xref:System.ComponentModel.BackgroundWorker> für den asynchronen Vorgang mit dem **Windows** **Forms-Designer** erstellen.</span><span class="sxs-lookup"><span data-stu-id="1f344-129">You can create the <xref:System.ComponentModel.BackgroundWorker> for your asynchronous operation using the **Windows** **Forms Designer**.</span></span>

<span data-ttu-id="1f344-130">Ziehen Sie auf der Registerkarte **Komponenten** der **Toolbox** eine <xref:System.ComponentModel.BackgroundWorker> auf das Formular.</span><span class="sxs-lookup"><span data-stu-id="1f344-130">From the **Components** tab of the **Toolbox**, drag a <xref:System.ComponentModel.BackgroundWorker> onto the form.</span></span>

## <a name="add-asynchronous-event-handlers"></a><span data-ttu-id="1f344-131">Asynchrone Ereignishandler hinzufügen</span><span class="sxs-lookup"><span data-stu-id="1f344-131">Add asynchronous event handlers</span></span>

<span data-ttu-id="1f344-132">Sie können nun Ereignishandler für die <xref:System.ComponentModel.BackgroundWorker> asynchronen Ereignisse der Komponente hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="1f344-132">You are now ready to add event handlers for the <xref:System.ComponentModel.BackgroundWorker> component's asynchronous events.</span></span> <span data-ttu-id="1f344-133">Der zeitaufwändige Vorgang im Hintergrund, der die Fibonacci-Zahlen berechnet, wird von einem dieser Ereignishandler aufgerufen.</span><span class="sxs-lookup"><span data-stu-id="1f344-133">The time-consuming operation that will run in the background, which computes Fibonacci numbers, is called by one of these event handlers.</span></span>

1. <span data-ttu-id="1f344-134">Klicken Sie im Fenster **Eigenschaften** , während die <xref:System.ComponentModel.BackgroundWorker> Komponente noch ausgewählt ist, auf die Schaltfläche **Ereignisse** .</span><span class="sxs-lookup"><span data-stu-id="1f344-134">In the **Properties** window, with the <xref:System.ComponentModel.BackgroundWorker> component still selected, click the **Events** button.</span></span> <span data-ttu-id="1f344-135">Doppelklicken Sie <xref:System.ComponentModel.BackgroundWorker.DoWork> auf das-Ereignis und das- <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> Ereignis, um Ereignishandler zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="1f344-135">Double-click the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> events to create event handlers.</span></span> <span data-ttu-id="1f344-136">Informationen zur Verwendung von Ereignishandlern finden Sie unter [Vorgehensweise: Erstellen von Ereignishandlern mithilfe des Designers](/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="1f344-136">For more information about how to use event handlers, see [How to: Create Event Handlers Using the Designer](/previous-versions/visualstudio/visual-studio-2010/zwwsdtbk(v=vs.100)).</span></span>

2. <span data-ttu-id="1f344-137">Erstellen Sie im Formular eine neue Methode namens `ComputeFibonacci`.</span><span class="sxs-lookup"><span data-stu-id="1f344-137">Create a new method, called `ComputeFibonacci`, in your form.</span></span> <span data-ttu-id="1f344-138">Diese Methode führt die eigentliche Arbeit aus und wird im Hintergrund ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="1f344-138">This method does the actual work, and it will run in the background.</span></span> <span data-ttu-id="1f344-139">Dieser Code veranschaulicht die rekursive Umsetzung des Fibonacci-Algorithmus, der deutlich ineffizient ist und wesentlich mehr Zeit in Anspruch nimmt, große Zahlen abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="1f344-139">This code demonstrates the recursive implementation of the Fibonacci algorithm, which is notably inefficient, taking exponentially longer time to complete for larger numbers.</span></span> <span data-ttu-id="1f344-140">Er wird hier verwendet, um einen Vorgang zu veranschaulichen, der lange Verzögerungen in der Anwendung verursachen kann.</span><span class="sxs-lookup"><span data-stu-id="1f344-140">It is used here for illustrative purposes, to show an operation that can introduce long delays in your application.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#10)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#10)]
     [!code-vb[System.ComponentModel.BackgroundWorker#10](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#10)]

3. <span data-ttu-id="1f344-141"><xref:System.ComponentModel.BackgroundWorker.DoWork>Fügen Sie im-Ereignishandler einen aufzurufenden- `ComputeFibonacci` Methode hinzu.</span><span class="sxs-lookup"><span data-stu-id="1f344-141">In the <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler, add a call to the `ComputeFibonacci` method.</span></span> <span data-ttu-id="1f344-142">Verwenden Sie den ersten Parameter für `ComputeFibonacci` aus der- <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> Eigenschaft der <xref:System.ComponentModel.DoWorkEventArgs> .</span><span class="sxs-lookup"><span data-stu-id="1f344-142">Take the first parameter for `ComputeFibonacci` from the <xref:System.ComponentModel.DoWorkEventArgs.Argument%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>.</span></span> <span data-ttu-id="1f344-143">Der <xref:System.ComponentModel.BackgroundWorker> -Parameter und der- <xref:System.ComponentModel.DoWorkEventArgs> Parameter werden später für die Fortschritts Berichterstattung und Abbruch Unterstützung verwendet.</span><span class="sxs-lookup"><span data-stu-id="1f344-143">The <xref:System.ComponentModel.BackgroundWorker> and <xref:System.ComponentModel.DoWorkEventArgs> parameters will be used later for progress reporting and cancellation support.</span></span> <span data-ttu-id="1f344-144">Weisen Sie der-Eigenschaft des den Rückgabewert von `ComputeFibonacci` zu <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> <xref:System.ComponentModel.DoWorkEventArgs> .</span><span class="sxs-lookup"><span data-stu-id="1f344-144">Assign the return value from `ComputeFibonacci` to the <xref:System.ComponentModel.DoWorkEventArgs.Result%2A> property of the <xref:System.ComponentModel.DoWorkEventArgs>.</span></span> <span data-ttu-id="1f344-145">Dieses Ergebnis steht dem- <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> Ereignishandler zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="1f344-145">This result will be available to the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1f344-146">Der <xref:System.ComponentModel.BackgroundWorker.DoWork> Ereignishandler verweist nicht `backgroundWorker1` direkt auf die Instanzvariable, da dieser Ereignishandler mit einer bestimmten Instanz von verknüpfen würde <xref:System.ComponentModel.BackgroundWorker> .</span><span class="sxs-lookup"><span data-stu-id="1f344-146">The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler does not reference the `backgroundWorker1` instance variable directly, as this would couple this event handler to a specific instance of <xref:System.ComponentModel.BackgroundWorker>.</span></span> <span data-ttu-id="1f344-147">Stattdessen wird ein Verweis auf den, der <xref:System.ComponentModel.BackgroundWorker> Dieses Ereignis ausgelöst hat, aus dem-Parameter wieder hergestellt `sender` .</span><span class="sxs-lookup"><span data-stu-id="1f344-147">Instead, a reference to the <xref:System.ComponentModel.BackgroundWorker> that raised this event is recovered from the `sender` parameter.</span></span> <span data-ttu-id="1f344-148">Dies ist wichtig, wenn das Formular mehrere Hosts hostet <xref:System.ComponentModel.BackgroundWorker> .</span><span class="sxs-lookup"><span data-stu-id="1f344-148">This is important when the form hosts more than one <xref:System.ComponentModel.BackgroundWorker>.</span></span> <span data-ttu-id="1f344-149">Es ist auch wichtig, keine Benutzeroberflächen Objekte in Ihrem <xref:System.ComponentModel.BackgroundWorker.DoWork> Ereignishandler zu bearbeiten.</span><span class="sxs-lookup"><span data-stu-id="1f344-149">It is also important not to manipulate any user-interface objects in your <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler.</span></span> <span data-ttu-id="1f344-150">Kommunizieren Sie stattdessen über die-Ereignisse mit der Benutzeroberfläche <xref:System.ComponentModel.BackgroundWorker> .</span><span class="sxs-lookup"><span data-stu-id="1f344-150">Instead, communicate to the user interface through the <xref:System.ComponentModel.BackgroundWorker> events.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#5)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#5)]
     [!code-vb[System.ComponentModel.BackgroundWorker#5](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#5)]

4. <span data-ttu-id="1f344-151">`startAsyncButton`Fügen Sie im- <xref:System.Windows.Forms.Control.Click> Ereignishandler des Steuer Elements den Code hinzu, der den asynchronen Vorgang startet.</span><span class="sxs-lookup"><span data-stu-id="1f344-151">In the `startAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that starts the asynchronous operation.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#13)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#13)]
     [!code-vb[System.ComponentModel.BackgroundWorker#13](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#13)]

5. <span data-ttu-id="1f344-152"><xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted>Weisen Sie im-Ereignishandler das Ergebnis der Berechnung dem-Steuerelement zu `resultLabel` .</span><span class="sxs-lookup"><span data-stu-id="1f344-152">In the <xref:System.ComponentModel.BackgroundWorker.RunWorkerCompleted> event handler, assign the result of the calculation to the `resultLabel` control.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#6)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#6)]
     [!code-vb[System.ComponentModel.BackgroundWorker#6](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#6)]

## <a name="adding-progress-reporting-and-support-for-cancellation"></a><span data-ttu-id="1f344-153">Hinzufügen von Statusberichterstellung und Abbruchunterstützung</span><span class="sxs-lookup"><span data-stu-id="1f344-153">Adding Progress Reporting and Support for Cancellation</span></span>

<span data-ttu-id="1f344-154">Bei asynchronen Vorgängen, die viel Zeit in Anspruch nehmen, ist es oft ratsam, dem Benutzer den Fortschritt zu berichten und die Möglichkeit zu geben, den Vorgang abzubrechen.</span><span class="sxs-lookup"><span data-stu-id="1f344-154">For asynchronous operations that will take a long time, it is often desirable to report progress to the user and to allow the user to cancel the operation.</span></span> <span data-ttu-id="1f344-155">Die- <xref:System.ComponentModel.BackgroundWorker> Klasse stellt ein Ereignis bereit, das es Ihnen ermöglicht, den Fortschritt während des Vorgangs im Hintergrund zu veröffentlichen.</span><span class="sxs-lookup"><span data-stu-id="1f344-155">The <xref:System.ComponentModel.BackgroundWorker> class provides an event that allows you to post progress as your background operation proceeds.</span></span> <span data-ttu-id="1f344-156">Außerdem wird ein Flag bereitgestellt, mit dem Ihr Workercode einen-Rückruf erkennen <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> und selbst unterbrechen kann.</span><span class="sxs-lookup"><span data-stu-id="1f344-156">It also provides a flag that allows your worker code to detect a call to <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> and interrupt itself.</span></span>

### <a name="implement-progress-reporting"></a><span data-ttu-id="1f344-157">Implementieren der Fortschritts Berichterstattung</span><span class="sxs-lookup"><span data-stu-id="1f344-157">Implement progress reporting</span></span>

1. <span data-ttu-id="1f344-158">Wählen Sie im Fenster **Eigenschaften**`backgroundWorker1` aus.</span><span class="sxs-lookup"><span data-stu-id="1f344-158">In the **Properties**, window, select `backgroundWorker1`.</span></span> <span data-ttu-id="1f344-159">Legen Sie für die Eigenschaften <xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A> (Breite) und <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> (Höhe) den Wert `true` fest.</span><span class="sxs-lookup"><span data-stu-id="1f344-159">Set the <xref:System.ComponentModel.BackgroundWorker.WorkerReportsProgress%2A> and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`.</span></span>

2. <span data-ttu-id="1f344-160">Deklarieren Sie zwei Variablen im Formular `FibonacciCalculator`.</span><span class="sxs-lookup"><span data-stu-id="1f344-160">Declare two variables in the `FibonacciCalculator` form.</span></span> <span data-ttu-id="1f344-161">Diese werden verwendet, um den Fortschritt nachzuverfolgen.</span><span class="sxs-lookup"><span data-stu-id="1f344-161">These will be used to track progress.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#14)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#14)]
     [!code-vb[System.ComponentModel.BackgroundWorker#14](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#14)]

3. <span data-ttu-id="1f344-162">Fügen Sie einen Ereignishandler für das <xref:System.ComponentModel.BackgroundWorker.ProgressChanged>-Ereignis hinzu.</span><span class="sxs-lookup"><span data-stu-id="1f344-162">Add an event handler for the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event.</span></span> <span data-ttu-id="1f344-163">Aktualisieren Sie im- <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> Ereignishandler <xref:System.Windows.Forms.ProgressBar> mit der- <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> Eigenschaft des- <xref:System.ComponentModel.ProgressChangedEventArgs> Parameters.</span><span class="sxs-lookup"><span data-stu-id="1f344-163">In the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler, update the <xref:System.Windows.Forms.ProgressBar> with the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> property of the <xref:System.ComponentModel.ProgressChangedEventArgs> parameter.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#7)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#7)]
     [!code-vb[System.ComponentModel.BackgroundWorker#7](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#7)]

### <a name="implement-support-for-cancellation"></a><span data-ttu-id="1f344-164">Unterstützung für Abbruch implementieren</span><span class="sxs-lookup"><span data-stu-id="1f344-164">Implement support for cancellation</span></span>

1. <span data-ttu-id="1f344-165">`cancelAsyncButton`Fügen Sie im- <xref:System.Windows.Forms.Control.Click> Ereignishandler des Steuer Elements den Code hinzu, der den asynchronen Vorgang abbricht.</span><span class="sxs-lookup"><span data-stu-id="1f344-165">In the `cancelAsyncButton` control's <xref:System.Windows.Forms.Control.Click> event handler, add the code that cancels the asynchronous operation.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#4)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#4)]
     [!code-vb[System.ComponentModel.BackgroundWorker#4](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#4)]

2. <span data-ttu-id="1f344-166">Die folgenden Codefragmente in der Methode `ComputeFibonacci` berichten Fortschritt und Abbruchunterstützung.</span><span class="sxs-lookup"><span data-stu-id="1f344-166">The following code fragments in the `ComputeFibonacci` method report progress and support cancellation.</span></span>

     [!code-cpp[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#11)]
     [!code-csharp[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#11)]
     [!code-vb[System.ComponentModel.BackgroundWorker#11](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#11)]
    [!code-cpp[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/cpp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CPP/fibonacciform.cpp#12)]
    [!code-csharp[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/csharp/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/CS/fibonacciform.cs#12)]
    [!code-vb[System.ComponentModel.BackgroundWorker#12](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.ComponentModel.BackgroundWorker/VB/fibonacciform.vb#12)]

## <a name="checkpoint"></a><span data-ttu-id="1f344-167">Prüfpunkt</span><span class="sxs-lookup"><span data-stu-id="1f344-167">Checkpoint</span></span>

<span data-ttu-id="1f344-168">An diesem Punkt können Sie die Anwendung Fibonacci Calculator kompilieren.</span><span class="sxs-lookup"><span data-stu-id="1f344-168">At this point, you can compile and run the Fibonacci Calculator application.</span></span>

<span data-ttu-id="1f344-169">Drücken Sie **F5** , um die Anwendung zu kompilieren und auszuführen.</span><span class="sxs-lookup"><span data-stu-id="1f344-169">Press **F5** to compile and run the application.</span></span>

<span data-ttu-id="1f344-170">Während die Berechnung im Hintergrund ausgeführt wird, sehen Sie, dass der <xref:System.Windows.Forms.ProgressBar> Fortschritt der Berechnung bis zur Fertigstellung angezeigt wird.</span><span class="sxs-lookup"><span data-stu-id="1f344-170">While the calculation is running in the background, you will see the <xref:System.Windows.Forms.ProgressBar> displaying the progress of the calculation toward completion.</span></span> <span data-ttu-id="1f344-171">Sie können auch ausstehenden Vorgang auch abbrechen.</span><span class="sxs-lookup"><span data-stu-id="1f344-171">You can also cancel the pending operation.</span></span>

<span data-ttu-id="1f344-172">Bei kleinen Zahlen sollte die Berechnung sehr schnell sein, aber bei größeren Zahlen sollten Sie eine merkliche Verzögerung feststellen.</span><span class="sxs-lookup"><span data-stu-id="1f344-172">For small numbers, the calculation should be very fast, but for larger numbers, you should see a noticeable delay.</span></span> <span data-ttu-id="1f344-173">Wenn Sie einen Wert von 30 oder höher eingeben, sollten Sie, abhängig von Ihrem Computer, eine Verzögerung von mehreren Sekunden feststellen.</span><span class="sxs-lookup"><span data-stu-id="1f344-173">If you enter a value of 30 or greater, you should see a delay of several seconds, depending on the speed of your computer.</span></span> <span data-ttu-id="1f344-174">Bei Werten, die höher als 40 sind, kann es Minuten oder Stunden dauern, die Berechnung abzuschließen.</span><span class="sxs-lookup"><span data-stu-id="1f344-174">For values greater than 40, it may take minutes or hours to finish the calculation.</span></span> <span data-ttu-id="1f344-175">Beachten Sie, dass Sie das Formular frei verschieben, minimieren, maximieren und sogar schließen, während der Rechner eine hohe Fibonacci-Zahl berechnet.</span><span class="sxs-lookup"><span data-stu-id="1f344-175">While the calculator is busy computing a large Fibonacci number, notice that you can freely move the form around, minimize, maximize, and even dismiss it.</span></span> <span data-ttu-id="1f344-176">Dies liegt daran, dass der Haupt-UI-Thread nicht wartet, bis die Berechnung abgeschlossen ist.</span><span class="sxs-lookup"><span data-stu-id="1f344-176">This is because the main UI thread is not waiting for the calculation to finish.</span></span>

## <a name="next-steps"></a><span data-ttu-id="1f344-177">Nächste Schritte</span><span class="sxs-lookup"><span data-stu-id="1f344-177">Next steps</span></span>

<span data-ttu-id="1f344-178">Nachdem Sie nun ein Formular implementiert haben, das eine- <xref:System.ComponentModel.BackgroundWorker> Komponente zum Ausführen einer Berechnung im Hintergrund verwendet, können Sie weitere Möglichkeiten für asynchrone Vorgänge untersuchen:</span><span class="sxs-lookup"><span data-stu-id="1f344-178">Now that you have implemented a form that uses a <xref:System.ComponentModel.BackgroundWorker> component to execute a computation in the background, you can explore other possibilities for asynchronous operations:</span></span>

- <span data-ttu-id="1f344-179">Verwenden Sie mehrere- <xref:System.ComponentModel.BackgroundWorker> Objekte für mehrere gleichzeitige Vorgänge.</span><span class="sxs-lookup"><span data-stu-id="1f344-179">Use multiple <xref:System.ComponentModel.BackgroundWorker> objects for several simultaneous operations.</span></span>

- <span data-ttu-id="1f344-180">Informationen zum Debuggen Ihrer Multithreadanwendung finden Sie unter [Vorgehensweise: Verwenden des Fensters „Threads“](/visualstudio/debugger/how-to-use-the-threads-window).</span><span class="sxs-lookup"><span data-stu-id="1f344-180">To debug your multithreaded application, see [How to: Use the Threads Window](/visualstudio/debugger/how-to-use-the-threads-window).</span></span>

- <span data-ttu-id="1f344-181">Implementieren Sie eine eigene Komponente, die das asynchrone Programmiermodell unterstützt.</span><span class="sxs-lookup"><span data-stu-id="1f344-181">Implement your own component that supports the asynchronous programming model.</span></span> <span data-ttu-id="1f344-182">Weitere Informationen finden Sie unter [Übersicht über ereignisbasierte asynchrone Muster](/dotnet/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview).</span><span class="sxs-lookup"><span data-stu-id="1f344-182">For more information, see [Event-based Asynchronous Pattern Overview](/dotnet/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview).</span></span>

    > [!CAUTION]
    > <span data-ttu-id="1f344-183">Wenn Sie Multithreading verwenden, setzen Sie sich möglicherweise sehr ernsten und komplexen Problemen aus.</span><span class="sxs-lookup"><span data-stu-id="1f344-183">When using multithreading of any sort, you potentially expose yourself to very serious and complex bugs.</span></span> <span data-ttu-id="1f344-184">Beachten Sie die Informationen unter [Empfohlene Vorgehensweise für das verwaltete Threading](/dotnet/standard/threading/managed-threading-best-practices), bevor Sie eine Projektmappe implementieren, die Multithreading verwendet.</span><span class="sxs-lookup"><span data-stu-id="1f344-184">Consult the [Managed Threading Best Practices](/dotnet/standard/threading/managed-threading-best-practices) before implementing any solution that uses multithreading.</span></span>

## <a name="see-also"></a><span data-ttu-id="1f344-185">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="1f344-185">See also</span></span>

- <xref:System.ComponentModel.BackgroundWorker?displayProperty=nameWithType>
- [<span data-ttu-id="1f344-186">Verwaltetes Threading</span><span class="sxs-lookup"><span data-stu-id="1f344-186">Managed Threading</span></span>](/dotnet/standard/threading/index)
- [<span data-ttu-id="1f344-187">Empfohlene Vorgehensweise für das verwaltete Threading</span><span class="sxs-lookup"><span data-stu-id="1f344-187">Managed Threading Best Practices</span></span>](/dotnet/standard/threading/managed-threading-best-practices)
- [<span data-ttu-id="1f344-188">Event-based Asynchronous Pattern Overview (Übersicht über ereignisbasierte asynchrone Muster)</span><span class="sxs-lookup"><span data-stu-id="1f344-188">Event-based Asynchronous Pattern Overview</span></span>](/dotnet/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-overview)
- [<span data-ttu-id="1f344-189">How to: Implementieren eines Formulars, das eine Hintergrundoperation verwendet</span><span class="sxs-lookup"><span data-stu-id="1f344-189">How to: Implement a Form That Uses a Background Operation</span></span>](how-to-implement-a-form-that-uses-a-background-operation.md)
- [<span data-ttu-id="1f344-190">Exemplarische Vorgehensweise: Ausführen eines Vorgangs im Hintergrund</span><span class="sxs-lookup"><span data-stu-id="1f344-190">Walkthrough: Running an Operation in the Background</span></span>](walkthrough-running-an-operation-in-the-background.md)
- [<span data-ttu-id="1f344-191">BackgroundWorker-Komponente</span><span class="sxs-lookup"><span data-stu-id="1f344-191">BackgroundWorker Component</span></span>](backgroundworker-component.md)
